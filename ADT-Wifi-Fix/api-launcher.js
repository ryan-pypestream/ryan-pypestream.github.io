!function(){"use strict";function e(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(o,i){var a=t.apply(n,r);function s(t){e(a,o,i,s,c,"next",t)}function c(t){e(a,o,i,s,c,"throw",t)}s(void 0)}))}}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a={exports:{}},s={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(s),function(e){var t=s.exports.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var r={},o=Object.prototype,i=o.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return T()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=f(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=d;var p={};function m(){}function h(){}function v(){}var g={};l(g,s,(function(){return this}));var y=Object.getPrototypeOf,w=y&&y(y(A([])));w&&w!==o&&i.call(w,s)&&(g=w);var b=v.prototype=m.prototype=Object.create(g);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,n){function r(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==t(d)&&i.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):n.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;this._invoke=function(e,t){function i(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(i,i):i()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=f(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,p;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=v,l(b,"constructor",v),l(v,"constructor",h),h.displayName=l(v,u,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},r.awrap=function(e){return{__await:e}},E(k.prototype),l(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(e,t,n,o,i){void 0===i&&(i=Promise);var a=new k(d(e,t,n,o),i);return r.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(b),l(b,u,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},r.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},r}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(a);var c=a.exports(),u=c;try{regeneratorRuntime=c}catch(e){"object"===("undefined"==typeof globalThis?"undefined":o(globalThis))?globalThis.regeneratorRuntime=c:Function("r","regeneratorRuntime = r")(c)}function l(e){try{return sessionStorage.getItem(e)}catch(e){return null}}var d=function(){return null!=navigator.userAgent.match(/Android|android|BlackBerry|iPhone|iPod|Opera Mini|IEMobile|webOS|Windows Phone/i)},f=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,m=/^0b[01]+$/i,h=/^0o[0-7]+$/i,v=parseInt,g="object"==o(i)&&i&&i.Object===Object&&i,y="object"==("undefined"==typeof self?"undefined":o(self))&&self&&self.Object===Object&&self,w=g||y||Function("return this")(),b=Object.prototype.toString,E=Math.max,k=Math.min,S=function(){return w.Date.now()};function x(e){var t=o(e);return!!e&&("object"==t||"function"==t)}function C(e){return"symbol"==o(e)||function(e){return!!e&&"object"==o(e)}(e)&&"[object Symbol]"==b.call(e)}function _(e){if("number"==typeof e)return e;if(C(e))return NaN;if(x(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=x(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(f,"");var n=m.test(e);return n||h.test(e)?v(e.slice(2),n?2:8):p.test(e)?NaN:+e}var A=function(e,t,n){var r,o,i,a,s,c,u=0,l=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=r,i=o;return r=o=void 0,u=t,a=e.apply(i,n)}function m(e){return u=e,s=setTimeout(v,t),l?p(e):a}function h(e){var n=e-c;return void 0===c||n>=t||n<0||d&&e-u>=i}function v(){var e=S();if(h(e))return g(e);s=setTimeout(v,function(e){var n=t-(e-c);return d?k(n,i-(e-u)):n}(e))}function g(e){return s=void 0,f&&r?p(e):(r=o=void 0,a)}function y(){var e=S(),n=h(e);if(r=arguments,o=this,c=e,n){if(void 0===s)return m(c);if(d)return s=setTimeout(v,t),p(c)}return void 0===s&&(s=setTimeout(v,t)),a}return t=_(t)||0,x(n)&&(l=!!n.leading,i=(d="maxWait"in n)?E(_(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f),y.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=c=o=s=void 0},y.flush=function(){return void 0===s?a:g(S())},y};A((function(e){setTimeout((function(){var t;null==e||e.focus(),null==e||null===(t=e.classList)||void 0===t||t.add("focus-visible"),null==e||e.setAttribute("data-focus-visible-added",!0)}),350)}),3e3,{leading:!0,trailing:!1}),A((function(e){setTimeout((function(){var t;null==e||e.focus(),null==e||null===(t=e.classList)||void 0===t||t.add("focus-visible"),null==e||e.setAttribute("data-focus-visible-added",!0)}),750)}),1750,{leading:!0,trailing:!1}),A((function(e){setTimeout((function(){var t;null==e||e.focus(),null==e||null===(t=e.classList)||void 0===t||t.add("focus-visible"),null==e||e.setAttribute("data-focus-visible-added",!0)}),750)}),1750,{leading:!0,trailing:!0});var T=!1;if("undefined"!=typeof window){var O={get passive(){T=!0}};window.addEventListener("testPassive",null,O),window.removeEventListener("testPassive",null,O)}var L="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1),F=[],P=!1,I=-1,D=void 0,N=void 0,R=void 0,M=function(e){return F.some((function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))}))},j=function(e){var t=e||window.event;return!!M(t.target)||(t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1))},U=function(){void 0!==R&&(document.body.style.paddingRight=R,R=void 0),void 0!==D&&(document.body.style.overflow=D,D=void 0)},H=function(){if(void 0!==N){var e=-parseInt(document.body.style.top,10),t=-parseInt(document.body.style.left,10);document.body.style.position=N.position,document.body.style.top=N.top,document.body.style.left=N.left,window.scrollTo(t,e),N=void 0}},W=function(e,t){if(e){if(!F.some((function(t){return t.targetElement===e}))){var n={targetElement:e,options:t||{}};F=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(F),[n]),L?window.requestAnimationFrame((function(){if(void 0===N){N={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left};var e=window,t=e.scrollY,n=e.scrollX,r=e.innerHeight;document.body.style.position="fixed",document.body.style.top=-t,document.body.style.left=-n,setTimeout((function(){return window.requestAnimationFrame((function(){var e=r-window.innerHeight;e&&t>=r&&(document.body.style.top=-(t+e))}))}),300)}})):function(e){if(void 0===R){var t=!!e&&!0===e.reserveScrollBarGap,n=window.innerWidth-document.documentElement.clientWidth;if(t&&n>0){var r=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right"),10);R=document.body.style.paddingRight,document.body.style.paddingRight=r+n+"px"}}void 0===D&&(D=document.body.style.overflow,document.body.style.overflow="hidden")}(t),L&&(e.ontouchstart=function(e){1===e.targetTouches.length&&(I=e.targetTouches[0].clientY)},e.ontouchmove=function(t){1===t.targetTouches.length&&function(e,t){var n=e.targetTouches[0].clientY-I;!M(e.target)&&(t&&0===t.scrollTop&&n>0||function(e){return!!e&&e.scrollHeight-e.scrollTop<=e.clientHeight}(t)&&n<0?j(e):e.stopPropagation())}(t,e)},P||(document.addEventListener("touchmove",j,T?{passive:!1}:void 0),P=!0))}}else console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.")},B=function(){L&&(F.forEach((function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null})),P&&(document.removeEventListener("touchmove",j,T?{passive:!1}:void 0),P=!1),I=-1),L?H():U(),F=[]},V=function(e){e?(F=F.filter((function(t){return t.targetElement!==e})),L&&(e.ontouchstart=null,e.ontouchmove=null,P&&0===F.length&&(document.removeEventListener("touchmove",j,T?{passive:!1}:void 0),P=!1)),L?H():U()):console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.")};
/*! @license DOMPurify 3.0.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.0/LICENSE */
function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function q(e,t){return q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},q(e,t)}function G(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function $(e,t,n){return $=G()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&q(o,n.prototype),o},$.apply(null,arguments)}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||K(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e){return function(e){if(Array.isArray(e))return X(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||K(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Q=Object.entries,Z=Object.setPrototypeOf,ee=Object.isFrozen,te=Object.getPrototypeOf,ne=Object.getOwnPropertyDescriptor,re=Object.freeze,oe=Object.seal,ie=Object.create,ae="undefined"!=typeof Reflect&&Reflect,se=ae.apply,ce=ae.construct;se||(se=function(e,t,n){return e.apply(t,n)}),re||(re=function(e){return e}),oe||(oe=function(e){return e}),ce||(ce=function(e,t){return $(e,J(t))});var ue,le=Ee(Array.prototype.forEach),de=Ee(Array.prototype.pop),fe=Ee(Array.prototype.push),pe=Ee(String.prototype.toLowerCase),me=Ee(String.prototype.toString),he=Ee(String.prototype.match),ve=Ee(String.prototype.replace),ge=Ee(String.prototype.indexOf),ye=Ee(String.prototype.trim),we=Ee(RegExp.prototype.test),be=(ue=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ce(ue,t)});function Ee(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return se(e,t,r)}}function ke(e,t,n){n=n||pe,Z&&Z(e,null);for(var r=t.length;r--;){var o=t[r];if("string"==typeof o){var i=n(o);i!==o&&(ee(t)||(t[r]=i),o=i)}e[o]=!0}return e}function Se(e){var t,n=ie(null),r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=K(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(Q(e));try{for(r.s();!(t=r.n()).done;){var o=Y(t.value,2),i=o[0],a=o[1];n[i]=a}}catch(e){r.e(e)}finally{r.f()}return n}function xe(e,t){for(;null!==e;){var n=ne(e,t);if(n){if(n.get)return Ee(n.get);if("function"==typeof n.value)return Ee(n.value)}e=te(e)}return function(e){return console.warn("fallback value for",e),null}}var Ce=re(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_e=re(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ae=re(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Te=re(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Oe=re(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Le=re(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Fe=re(["#text"]),Pe=re(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ie=re(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),De=re(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ne=re(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Re=oe(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Me=oe(/<%[\w\W]*|[\w\W]*%>/gm),je=oe(/\${[\w\W]*}/gm),Ue=oe(/^data-[\-\w.\u00B7-\uFFFF]/),He=oe(/^aria-[\-\w]+$/),We=oe(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Be=oe(/^(?:\w+script|data):/i),Ve=oe(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ze=oe(/^html$/i),qe=function(){return"undefined"==typeof window?null:window},Ge=function(e,t){if("object"!==z(e)||"function"!=typeof e.createPolicy)return null;var n=null,r="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(r)&&(n=t.currentScript.getAttribute(r));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};var $e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe(),n=function(t){return e(t)};if(n.version="3.0.0",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,o=t.document,i=t.DocumentFragment,a=t.HTMLTemplateElement,s=t.Node,c=t.Element,u=t.NodeFilter,l=t.NamedNodeMap,d=void 0===l?t.NamedNodeMap||t.MozNamedAttrMap:l,f=t.HTMLFormElement,p=t.DOMParser,m=t.trustedTypes,h=c.prototype,v=xe(h,"cloneNode"),g=xe(h,"nextSibling"),y=xe(h,"childNodes"),w=xe(h,"parentNode");if("function"==typeof a){var b=o.createElement("template");b.content&&b.content.ownerDocument&&(o=b.content.ownerDocument)}var E=Ge(m,r),k=E?E.createHTML(""):"",S=o,x=S.implementation,C=S.createNodeIterator,_=S.createDocumentFragment,A=S.getElementsByTagName,T=r.importNode,O={};n.isSupported="function"==typeof Q&&"function"==typeof w&&x&&void 0!==x.createHTMLDocument;var L,F,P=Re,I=Me,D=je,N=Ue,R=He,M=Be,j=Ve,U=We,H=null,W=ke({},[].concat(J(Ce),J(_e),J(Ae),J(Oe),J(Fe))),B=null,V=ke({},[].concat(J(Pe),J(Ie),J(De),J(Ne))),q=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,$=null,Y=!0,K=!0,X=!1,Z=!0,ee=!1,te=!1,ne=!1,oe=!1,ie=!1,ae=!1,se=!1,ce=!0,ue=!1,Ee="user-content-",$e=!0,Ye=!1,Je={},Ke=null,Xe=ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Qe=null,Ze=ke({},["audio","video","img","source","image","track"]),et=null,tt=ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nt="http://www.w3.org/1998/Math/MathML",rt="http://www.w3.org/2000/svg",ot="http://www.w3.org/1999/xhtml",it=ot,at=!1,st=null,ct=ke({},[nt,rt,ot],me),ut=["application/xhtml+xml","text/html"],lt="text/html",dt=null,ft=o.createElement("form"),pt=function(e){return e instanceof RegExp||e instanceof Function},mt=function(e){dt&&dt===e||(e&&"object"===z(e)||(e={}),e=Se(e),L=L=-1===ut.indexOf(e.PARSER_MEDIA_TYPE)?lt:e.PARSER_MEDIA_TYPE,F="application/xhtml+xml"===L?me:pe,H="ALLOWED_TAGS"in e?ke({},e.ALLOWED_TAGS,F):W,B="ALLOWED_ATTR"in e?ke({},e.ALLOWED_ATTR,F):V,st="ALLOWED_NAMESPACES"in e?ke({},e.ALLOWED_NAMESPACES,me):ct,et="ADD_URI_SAFE_ATTR"in e?ke(Se(tt),e.ADD_URI_SAFE_ATTR,F):tt,Qe="ADD_DATA_URI_TAGS"in e?ke(Se(Ze),e.ADD_DATA_URI_TAGS,F):Ze,Ke="FORBID_CONTENTS"in e?ke({},e.FORBID_CONTENTS,F):Xe,G="FORBID_TAGS"in e?ke({},e.FORBID_TAGS,F):{},$="FORBID_ATTR"in e?ke({},e.FORBID_ATTR,F):{},Je="USE_PROFILES"in e&&e.USE_PROFILES,Y=!1!==e.ALLOW_ARIA_ATTR,K=!1!==e.ALLOW_DATA_ATTR,X=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Z=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,ee=e.SAFE_FOR_TEMPLATES||!1,te=e.WHOLE_DOCUMENT||!1,ie=e.RETURN_DOM||!1,ae=e.RETURN_DOM_FRAGMENT||!1,se=e.RETURN_TRUSTED_TYPE||!1,oe=e.FORCE_BODY||!1,ce=!1!==e.SANITIZE_DOM,ue=e.SANITIZE_NAMED_PROPS||!1,$e=!1!==e.KEEP_CONTENT,Ye=e.IN_PLACE||!1,U=e.ALLOWED_URI_REGEXP||U,it=e.NAMESPACE||ot,e.CUSTOM_ELEMENT_HANDLING&&pt(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(q.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&pt(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(q.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(q.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ee&&(K=!1),ae&&(ie=!0),Je&&(H=ke({},J(Fe)),B=[],!0===Je.html&&(ke(H,Ce),ke(B,Pe)),!0===Je.svg&&(ke(H,_e),ke(B,Ie),ke(B,Ne)),!0===Je.svgFilters&&(ke(H,Ae),ke(B,Ie),ke(B,Ne)),!0===Je.mathMl&&(ke(H,Oe),ke(B,De),ke(B,Ne))),e.ADD_TAGS&&(H===W&&(H=Se(H)),ke(H,e.ADD_TAGS,F)),e.ADD_ATTR&&(B===V&&(B=Se(B)),ke(B,e.ADD_ATTR,F)),e.ADD_URI_SAFE_ATTR&&ke(et,e.ADD_URI_SAFE_ATTR,F),e.FORBID_CONTENTS&&(Ke===Xe&&(Ke=Se(Ke)),ke(Ke,e.FORBID_CONTENTS,F)),$e&&(H["#text"]=!0),te&&ke(H,["html","head","body"]),H.table&&(ke(H,["tbody"]),delete G.tbody),re&&re(e),dt=e)},ht=ke({},["mi","mo","mn","ms","mtext"]),vt=ke({},["foreignobject","desc","title","annotation-xml"]),gt=ke({},["title","style","font","a","script"]),yt=ke({},_e);ke(yt,Ae),ke(yt,Te);var wt=ke({},Oe);ke(wt,Le);var bt=function(e){var t=w(e);t&&t.tagName||(t={namespaceURI:it,tagName:"template"});var n=pe(e.tagName),r=pe(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===rt?t.namespaceURI===ot?"svg"===n:t.namespaceURI===nt?"svg"===n&&("annotation-xml"===r||ht[r]):Boolean(yt[n]):e.namespaceURI===nt?t.namespaceURI===ot?"math"===n:t.namespaceURI===rt?"math"===n&&vt[r]:Boolean(wt[n]):e.namespaceURI===ot?!(t.namespaceURI===rt&&!vt[r])&&(!(t.namespaceURI===nt&&!ht[r])&&(!wt[n]&&(gt[n]||!yt[n]))):!("application/xhtml+xml"!==L||!st[e.namespaceURI]))},Et=function(e){fe(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.remove()}},kt=function(e,t){try{fe(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){fe(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!B[e])if(ie||ae)try{Et(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},St=function(e){var t,n;if(oe)e="<remove></remove>"+e;else{var r=he(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===L&&it===ot&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=E?E.createHTML(e):e;if(it===ot)try{t=(new p).parseFromString(i,L)}catch(e){}if(!t||!t.documentElement){t=x.createDocument(it,"template",null);try{t.documentElement.innerHTML=at?k:i}catch(e){}}var a=t.body||t.documentElement;return e&&n&&a.insertBefore(o.createTextNode(n),a.childNodes[0]||null),it===ot?A.call(t,te?"html":"body")[0]:te?t.documentElement:a},xt=function(e){return C.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},Ct=function(e){return e instanceof f&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof d)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},_t=function(e){return"object"===z(s)?e instanceof s:e&&"object"===z(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},At=function(e,t,r){O[e]&&le(O[e],(function(e){e.call(n,t,r,dt)}))},Tt=function(e){var t;if(At("beforeSanitizeElements",e,null),Ct(e))return Et(e),!0;var r=F(e.nodeName);if(At("uponSanitizeElement",e,{tagName:r,allowedTags:H}),e.hasChildNodes()&&!_t(e.firstElementChild)&&(!_t(e.content)||!_t(e.content.firstElementChild))&&we(/<[/\w]/g,e.innerHTML)&&we(/<[/\w]/g,e.textContent))return Et(e),!0;if(!H[r]||G[r]){if(!G[r]&&Lt(r)){if(q.tagNameCheck instanceof RegExp&&we(q.tagNameCheck,r))return!1;if(q.tagNameCheck instanceof Function&&q.tagNameCheck(r))return!1}if($e&&!Ke[r]){var o=w(e)||e.parentNode,i=y(e)||e.childNodes;if(i&&o)for(var a=i.length-1;a>=0;--a)o.insertBefore(v(i[a],!0),g(e))}return Et(e),!0}return e instanceof c&&!bt(e)?(Et(e),!0):"noscript"!==r&&"noembed"!==r||!we(/<\/no(script|embed)/i,e.innerHTML)?(ee&&3===e.nodeType&&(t=e.textContent,t=ve(t,P," "),t=ve(t,I," "),t=ve(t,D," "),e.textContent!==t&&(fe(n.removed,{element:e.cloneNode()}),e.textContent=t)),At("afterSanitizeElements",e,null),!1):(Et(e),!0)},Ot=function(e,t,n){if(ce&&("id"===t||"name"===t)&&(n in o||n in ft))return!1;if(K&&!$[t]&&we(N,t));else if(Y&&we(R,t));else if(!B[t]||$[t]){if(!(Lt(e)&&(q.tagNameCheck instanceof RegExp&&we(q.tagNameCheck,e)||q.tagNameCheck instanceof Function&&q.tagNameCheck(e))&&(q.attributeNameCheck instanceof RegExp&&we(q.attributeNameCheck,t)||q.attributeNameCheck instanceof Function&&q.attributeNameCheck(t))||"is"===t&&q.allowCustomizedBuiltInElements&&(q.tagNameCheck instanceof RegExp&&we(q.tagNameCheck,n)||q.tagNameCheck instanceof Function&&q.tagNameCheck(n))))return!1}else if(et[t]);else if(we(U,ve(n,j,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==ge(n,"data:")||!Qe[e]){if(X&&!we(M,ve(n,j,"")));else if(n)return!1}else;return!0},Lt=function(e){return e.indexOf("-")>0},Ft=function(e){var t,r,o,i;At("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B};for(i=a.length;i--;){var c=t=a[i],u=c.name,l=c.namespaceURI;if(r="value"===u?t.value:ye(t.value),o=F(u),s.attrName=o,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,At("uponSanitizeAttribute",e,s),r=s.attrValue,!s.forceKeepAttr&&(kt(u,e),s.keepAttr))if(Z||!we(/\/>/i,r)){ee&&(r=ve(r,P," "),r=ve(r,I," "),r=ve(r,D," "));var d=F(e.nodeName);if(Ot(d,o,r)){if(!ue||"id"!==o&&"name"!==o||(kt(u,e),r=Ee+r),E&&"object"===z(m)&&"function"==typeof m.getAttributeType)if(l);else switch(m.getAttributeType(d,o)){case"TrustedHTML":r=E.createHTML(r);break;case"TrustedScriptURL":r=E.createScriptURL(r)}try{l?e.setAttributeNS(l,u,r):e.setAttribute(u,r),de(n.removed)}catch(e){}}}else kt(u,e)}At("afterSanitizeAttributes",e,null)}},Pt=function e(t){var n,r=xt(t);for(At("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)At("uponSanitizeShadowNode",n,null),Tt(n)||(n.content instanceof i&&e(n.content),Ft(n));At("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e){var t,o,a,c,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((at=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!_t(e)){if("function"!=typeof e.toString)throw be("toString is not a function");if("string"!=typeof(e=e.toString()))throw be("dirty is not a string, aborting")}if(!n.isSupported)return e;if(ne||mt(u),n.removed=[],"string"==typeof e&&(Ye=!1),Ye){if(e.nodeName){var l=F(e.nodeName);if(!H[l]||G[l])throw be("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof s)1===(o=(t=St("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===o.nodeName||"HTML"===o.nodeName?t=o:t.appendChild(o);else{if(!ie&&!ee&&!te&&-1===e.indexOf("<"))return E&&se?E.createHTML(e):e;if(!(t=St(e)))return ie?null:se?k:""}t&&oe&&Et(t.firstChild);for(var d=xt(Ye?e:t);a=d.nextNode();)Tt(a)||(a.content instanceof i&&Pt(a.content),Ft(a));if(Ye)return e;if(ie){if(ae)for(c=_.call(t.ownerDocument);t.firstChild;)c.appendChild(t.firstChild);else c=t;return(B.shadowroot||B.shadowrootmod)&&(c=T.call(r,c,!0)),c}var f=te?t.outerHTML:t.innerHTML;return te&&H["!doctype"]&&t.ownerDocument&&t.ownerDocument.doctype&&t.ownerDocument.doctype.name&&we(ze,t.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+t.ownerDocument.doctype.name+">\n"+f),ee&&(f=ve(f,P," "),f=ve(f,I," "),f=ve(f,D," ")),E&&se?E.createHTML(f):f},n.setConfig=function(e){mt(e),ne=!0},n.clearConfig=function(){dt=null,ne=!1},n.isValidAttribute=function(e,t,n){dt||mt({});var r=F(e),o=F(t);return Ot(r,o,n)},n.addHook=function(e,t){"function"==typeof t&&(O[e]=O[e]||[],fe(O[e],t))},n.removeHook=function(e){if(O[e])return de(O[e])},n.removeHooks=function(e){O[e]&&(O[e]=[])},n.removeAllHooks=function(){O={}},n}(),Ye=function(){var e=document.createElement("div");e.className="ps-sr-only",e.id="pypestream-sr-only-wrapper";var t=document.createElement("div");t.setAttribute("id","pypestream-aria-live-assertive"),t.setAttribute("role","log"),t.setAttribute("aria-live","assertive"),t.setAttribute("aria-busy",!1);var n=document.createElement("div");return n.setAttribute("id","pypestream-aria-live-polite"),n.setAttribute("role","log"),n.setAttribute("aria-live","polite"),n.setAttribute("aria-busy",!1),e.appendChild(t),e.appendChild(n),{wrapperElement:e,politeElement:n,assertiveElement:t}},Je=function(e){var t=e.iframe,n=e.event;t.contentWindow.postMessage("CUSTOM_EVENT:".concat(JSON.stringify(n.detail)),"*"),console.log("[Pype] Event pushed to API: ",n.type,n.detail)},Ke=function(e){var t=e.registerForEvents,n=e.customEventQueue,r=e.getIframe,o=e.getHasSetupCompleted;if(t){var i=t.eventHandles,a=t.eventTarget||window,s=t.eventsBuffer;i&&i.length?(s&&s.forEach((function(e){n.push(e)})),i.forEach((function(e){a.addEventListener(e,(function(e){o()?Je({iframe:r(),event:e}):(n.push(e),console.log("[Pype] Event queued: ",e.type,e.detail,n))}))}))):console.warn("You must pass array of custom events")}},Xe=function(e){var t=e.customEventQueue,n=e.iframe;t.forEach((function(e){Je({iframe:n,event:e}),console.log("[Pype] Dequeued event pushed to API: ",e.type,e.detail)})),t=[]},Qe=function(e){var t=document.location.href;window.addEventListener("hashchange",(function(){var n=window.location.href;t!==n&&(t=n,e(n))}));var n=document.querySelector("body");new MutationObserver((function(n){n.forEach((function(){var n=window.location.href;t!==n&&(t=n,e(n))}))})).observe(n,{childList:!0,subtree:!0})};function Ze(e){var t,n;void 0!==document.hidden?(t="hidden",n="visibilitychange"):void 0!==document.msHidden?(t="msHidden",n="msvisibilitychange"):void 0!==document.webkitHidden&&(t="webkitHidden",n="webkitvisibilitychange"),document.addEventListener(n,(function(){e(t)}))}var et="pypestream-wrapper-styles",tt="pypestream-wrapper-styles-additional",nt={border:0,height:"100%",width:"100%"};function rt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ot(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var it=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.height,n=void 0===t?null:t,r=e.width,o=void 0===r?null:r,i=e.shouldShowLauncher,a=void 0===i||i,s=e.fixedPosition,c=void 0===s||s,u=e.otherStyles,l=void 0===u?{}:u,d=e.pe19536_FF,f=void 0!==d&&d,p=e.pe17591_FF,m=void 0!==p&&p,h=e.pe21222_FF,v=void 0!==h&&h,g=e.pe25604_FF,y=void 0!==g&&g,w=e.pe30718_FF,b=void 0!==w&&w,E=y?"0s":"0.4s",k=function(){var e=0;return o&&"number"==typeof o?e=o+10:o&&o.endsWith("px")&&(e=parseInt(o)+10),e?"\n        @media (max-width: ".concat(e,"px) {\n          #pypestream-wrapper.showing {\n            width: 100% !important;\n          }\n        }\n      "):""};return"\n    #pypestream-wrapper {\n      position: ".concat(c?"fixed":"static",";\n      bottom: ").concat(l.bottom||0,";\n      right: ").concat(l.right||0,";\n      max-height: 100%;\n      ").concat(a?"width: ".concat(330,"px;"):"",";\n      ").concat(a?"height: ".concat(74,"px;"):"",";\n      ").concat(c&&m?"z-index: 99999":"",";\n      ").concat(v?"transition:  width ".concat(E," ease-in-out, height ").concat(E," ease-in-out"):"",";\n    }\n  \n    #pypestream-wrapper.showing {\n      width: ").concat(o?"number"==typeof o?"".concat(o+10,"px"):"calc(".concat(o," + 10px)"):"".concat(510,"px"),";\n      height: ").concat(n?"number"==typeof n?"".concat(n+10,"px"):"calc(".concat(n," + 10px)"):"".concat(810,"px"),";\n      ").concat(v?"transition: width 0s ease-in-out, height 0.5s ease-in-out":"",";\n    }\n\n    #pypestream-wrapper.survey {\n      right: 16px;\n      bottom: 16px;\n      ").concat(f&&"max-height: calc(100% - 16px)",";\n      width: ").concat(o?"number"==typeof o?"".concat(o+10,"px"):"calc(".concat(o," + 10px)"):"".concat(510,"px"),";\n      height: ").concat(n?"number"==typeof n?"".concat(n+10,"px"):"calc(".concat(n," + 10px)"):"".concat(810,"px"),";\n    }\n\n\n    ").concat(b?k():"","\n  \n    @media (max-width: ").concat(480,"px) {\n      #pypestream-wrapper.showing {\n        position: fixed !important;\n        width: 100% !important;\n        height: 100% !important;\n        margin-left: 0 !important;\n        margin-top: 0 !important;\n        bottom: 0;\n        right: 0;\n      }\n\n      #pypestream-wrapper.survey {\n        position: fixed !important;\n        width: 100% !important;\n        height: 100% !important;\n        margin-left: 0 !important;\n        margin-top: 0 !important;\n        bottom: 16px;\n        right: 0;\n        left: 0;\n        ").concat(f&&"max-height: 100%",";\n      }\n    }\n\n    ")},at=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!document.getElementById(et)){var i=document.createElement("style");return i.id=et,i.innerHTML=e||t||n||r||o?it({pe19536_FF:e,pe17591_FF:t,pe21222_FF:n,pe25604_FF:r,pe30718_FF:o}):it(),document.head.appendChild(i),i}},st=function(){var e=document.createElement("style");return e.id="pypestream-common-launcher-styles",e.innerHTML="\n    .ps-sr-only {\n      border: 0;\n      clip: rect(0, 0, 0, 0);\n      height: 1px;\n      margin: -1px;\n      overflow: hidden;\n      padding: 0;\n      position: absolute;\n      width: 1px;\n      white-space: nowrap;\n    }\n    ",document.head.appendChild(e),e},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.height,n=e.width,r=e.shouldShowLauncher,o=void 0===r||r,i=e.fixedPosition,a=void 0===i||i,s=e.otherStyles,c=void 0===s?{}:s,u=e.pe19536_FF,l=void 0!==u&&u,d=e.pe17591_FF,f=void 0!==d&&d,p=e.pe21222_FF,m=void 0!==p&&p,h=e.pe25604_FF,v=void 0!==h&&h,g=e.pe30718_FF,y=void 0!==g&&g,w=document.getElementById(et);w.innerHTML=it({height:t,width:n,shouldShowLauncher:o,fixedPosition:a,otherStyles:c,pe19536_FF:l,pe17591_FF:f,pe21222_FF:m,pe25604_FF:v,pe30718_FF:y})},ut=[".ps-pypestream-wrapper",".ps-pypestream-iframe",".ps-loader-wrapper",".ps-loader",".ps-loader-circular-path",".ps-loader-svg-container",".ps-loader-logo-wrapper"],lt=function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=rt(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i.cssRules&&i.cssRules.length>0)e(i.cssRules,r);else{var a,s=rt(ut);try{for(s.s();!(a=s.n()).done;){var c=a.value;i.selectorText&&i.selectorText.startsWith(c)&&r.push(i.cssText)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){o.e(e)}finally{o.f()}},dt=function(e){var t,n=document.implementation.createHTMLDocument(""),r=document.createElement("style");r.textContent=e,n.body.appendChild(r);var o=null==r||null===(t=r.sheet)||void 0===t?void 0:t.cssRules,i=[];return o&&lt(o,i),i.length?i.join("\r\n"):null},ft=function(e){if(!document.getElementById(tt)&&dt(e)){var t=document.createElement("style");t.id=tt,t.innerHTML=dt(e),document.head.appendChild(t)}},pt=function(e,t){Object.keys(t).forEach((function(n){e.style[n]=t[n]}))};function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ht(e,t){if(e){if("string"==typeof e)return mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mt(e,t):void 0}}function vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||ht(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e){return function(e){if(Array.isArray(e))return mt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ht(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kt(e){function t(e,t){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.message=e,this.code=t}return t.prototype=new Error,t.prototype.name=e,t.prototype.constructor=t,t}for(var St=kt("LaunchDarklyUnexpectedResponseError"),xt=kt("LaunchDarklyInvalidEnvironmentIdError"),Ct=kt("LaunchDarklyInvalidUserError"),_t=kt("LaunchDarklyInvalidEventKeyError"),At=kt("LaunchDarklyInvalidArgumentError"),Tt=kt("LaunchDarklyFlagFetchError"),Ot={LDUnexpectedResponseError:St,LDInvalidEnvironmentIdError:xt,LDInvalidUserError:Ct,LDInvalidEventKeyError:_t,LDInvalidArgumentError:At,LDInvalidDataError:kt("LaunchDarklyInvalidDataError"),LDFlagFetchError:Tt,isHttpErrorRecoverable:function(e){return!(e>=400&&e<500)||400===e||408===e||429===e}},Lt=[],Ft=[],Pt=("undefined"!=typeof Uint8Array&&Uint8Array,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),It=0;It<64;++It)Lt[It]=Pt[It],Ft[Pt.charCodeAt(It)]=It;function Dt(e,t,n){for(var r,o,i=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(Lt[(o=r)>>18&63]+Lt[o>>12&63]+Lt[o>>6&63]+Lt[63&o]);return i.join("")}Ft["-".charCodeAt(0)]=62,Ft["_".charCodeAt(0)]=63;var Nt=function(e){for(var t,n=e.length,r=n%3,o=[],i=16383,a=0,s=n-r;a<s;a+=i)o.push(Dt(e,a,a+i>s?s:a+i));return 1===r?(t=e[n-1],o.push(Lt[t>>2]+Lt[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(Lt[t>>10]+Lt[t>>4&63]+Lt[t<<2&63]+"=")),o.join("")},Rt=Array.isArray,Mt=Object.keys,jt=Object.prototype.hasOwnProperty,Ut=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==o(t)&&"object"==o(n)){var r,i,a,s=Rt(t),c=Rt(n);if(s&&c){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(s!=c)return!1;var u=t instanceof Date,l=n instanceof Date;if(u!=l)return!1;if(u&&l)return t.getTime()==n.getTime();var d=t instanceof RegExp,f=n instanceof RegExp;if(d!=f)return!1;if(d&&f)return t.toString()==n.toString();var p=Mt(t);if((i=p.length)!==Mt(n).length)return!1;for(r=i;0!=r--;)if(!jt.call(n,p[r]))return!1;for(r=i;0!=r--;)if(!e(t[a=p[r]],n[a]))return!1;return!0}return t!=t&&n!=n},Ht=["key","ip","country","email","firstName","lastName","avatar","name"];function Wt(e){var t=unescape(encodeURIComponent(e));return Nt(function(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t}(t))}function Bt(e){return Wt(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Vt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var zt,qt={appendUrlPath:function(e,t){return(e.endsWith("/")?e.substring(0,e.length-1):e)+(t.startsWith("/")?"":"/")+t},base64URLEncode:Bt,btoa:Wt,chunkEventsForUrl:function(e,t){for(var n,r=t.slice(0),o=[],i=e;r.length>0;){for(n=[];i>0;){var a=r.shift();if(!a)break;(i-=Bt(JSON.stringify(a)).length)<0&&n.length>0?r.unshift(a):n.push(a)}i=e,o.push(n)}return o},clone:function(e){return JSON.parse(JSON.stringify(e))},deepEquals:function(e,t){return Ut(e,t)},extend:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return Et(Et({},e),t)}),{})},getLDUserAgentString:function(e){var t=e.version||"?";return e.userAgent+"/"+t},objectHasOwnProperty:Vt,onNextTick:function(e){setTimeout(e,0)},sanitizeContext:function(e){return e?(null!==e.kind&&void 0!==e.kind||Ht.forEach((function(n){var r=e[n];void 0!==r&&"string"!=typeof r&&((t=t||Et({},e))[n]=String(r))})),t||e):e;var t},transformValuesToVersionedValues:function(e){var t={};for(var n in e)Vt(e,n)&&(t[n]={value:e[n],version:0});return t},transformVersionedValuesToValues:function(e){var t={};for(var n in e)Vt(e,n)&&(t[n]=e[n].value);return t},wrapPromiseCallback:function(e,t){var n=e.then((function(e){return t&&setTimeout((function(){t(null,e)}),0),e}),(function(e){if(!t)return Promise.reject(e);setTimeout((function(){t(e,null)}),0)}));return t?void 0:n}},Gt=new Uint8Array(16);function $t(){if(!zt&&!(zt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return zt(Gt)}var Yt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Jt(e){return"string"==typeof e&&Yt.test(e)}for(var Kt,Xt,Qt=[],Zt=0;Zt<256;++Zt)Qt.push((Zt+256).toString(16).substr(1));function en(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Qt[e[t+0]]+Qt[e[t+1]]+Qt[e[t+2]]+Qt[e[t+3]]+"-"+Qt[e[t+4]]+Qt[e[t+5]]+"-"+Qt[e[t+6]]+Qt[e[t+7]]+"-"+Qt[e[t+8]]+Qt[e[t+9]]+"-"+Qt[e[t+10]]+Qt[e[t+11]]+Qt[e[t+12]]+Qt[e[t+13]]+Qt[e[t+14]]+Qt[e[t+15]]).toLowerCase();if(!Jt(n))throw TypeError("Stringified UUID is invalid");return n}var tn=0,nn=0;function rn(e){if(!Jt(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}function on(e,t,n){function r(e,r,o,i){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=rn(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),(a=n(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,o){i=i||0;for(var s=0;s<16;++s)o[i+s]=a[s];return o}return en(a)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function an(e){return 14+(e+64>>>9<<4)+1}function sn(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function cn(e,t,n,r,o,i){return sn((a=sn(sn(t,e),sn(r,i)))<<(s=o)|a>>>32-s,n);var a,s}function un(e,t,n,r,o,i,a){return cn(t&n|~t&r,e,t,o,i,a)}function ln(e,t,n,r,o,i,a){return cn(t&r|n&~r,e,t,o,i,a)}function dn(e,t,n,r,o,i,a){return cn(t^n^r,e,t,o,i,a)}function fn(e,t,n,r,o,i,a){return cn(n^(t|~r),e,t,o,i,a)}var pn=on("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,r="0123456789abcdef",o=0;o<n;o+=8){var i=e[o>>5]>>>o%32&255,a=parseInt(r.charAt(i>>>4&15)+r.charAt(15&i),16);t.push(a)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[an(t)-1]=t;for(var n=1732584193,r=-271733879,o=-1732584194,i=271733878,a=0;a<e.length;a+=16){var s=n,c=r,u=o,l=i;n=un(n,r,o,i,e[a],7,-680876936),i=un(i,n,r,o,e[a+1],12,-389564586),o=un(o,i,n,r,e[a+2],17,606105819),r=un(r,o,i,n,e[a+3],22,-1044525330),n=un(n,r,o,i,e[a+4],7,-176418897),i=un(i,n,r,o,e[a+5],12,1200080426),o=un(o,i,n,r,e[a+6],17,-1473231341),r=un(r,o,i,n,e[a+7],22,-45705983),n=un(n,r,o,i,e[a+8],7,1770035416),i=un(i,n,r,o,e[a+9],12,-1958414417),o=un(o,i,n,r,e[a+10],17,-42063),r=un(r,o,i,n,e[a+11],22,-1990404162),n=un(n,r,o,i,e[a+12],7,1804603682),i=un(i,n,r,o,e[a+13],12,-40341101),o=un(o,i,n,r,e[a+14],17,-1502002290),n=ln(n,r=un(r,o,i,n,e[a+15],22,1236535329),o,i,e[a+1],5,-165796510),i=ln(i,n,r,o,e[a+6],9,-1069501632),o=ln(o,i,n,r,e[a+11],14,643717713),r=ln(r,o,i,n,e[a],20,-373897302),n=ln(n,r,o,i,e[a+5],5,-701558691),i=ln(i,n,r,o,e[a+10],9,38016083),o=ln(o,i,n,r,e[a+15],14,-660478335),r=ln(r,o,i,n,e[a+4],20,-405537848),n=ln(n,r,o,i,e[a+9],5,568446438),i=ln(i,n,r,o,e[a+14],9,-1019803690),o=ln(o,i,n,r,e[a+3],14,-187363961),r=ln(r,o,i,n,e[a+8],20,1163531501),n=ln(n,r,o,i,e[a+13],5,-1444681467),i=ln(i,n,r,o,e[a+2],9,-51403784),o=ln(o,i,n,r,e[a+7],14,1735328473),n=dn(n,r=ln(r,o,i,n,e[a+12],20,-1926607734),o,i,e[a+5],4,-378558),i=dn(i,n,r,o,e[a+8],11,-2022574463),o=dn(o,i,n,r,e[a+11],16,1839030562),r=dn(r,o,i,n,e[a+14],23,-35309556),n=dn(n,r,o,i,e[a+1],4,-1530992060),i=dn(i,n,r,o,e[a+4],11,1272893353),o=dn(o,i,n,r,e[a+7],16,-155497632),r=dn(r,o,i,n,e[a+10],23,-1094730640),n=dn(n,r,o,i,e[a+13],4,681279174),i=dn(i,n,r,o,e[a],11,-358537222),o=dn(o,i,n,r,e[a+3],16,-722521979),r=dn(r,o,i,n,e[a+6],23,76029189),n=dn(n,r,o,i,e[a+9],4,-640364487),i=dn(i,n,r,o,e[a+12],11,-421815835),o=dn(o,i,n,r,e[a+15],16,530742520),n=fn(n,r=dn(r,o,i,n,e[a+2],23,-995338651),o,i,e[a],6,-198630844),i=fn(i,n,r,o,e[a+7],10,1126891415),o=fn(o,i,n,r,e[a+14],15,-1416354905),r=fn(r,o,i,n,e[a+5],21,-57434055),n=fn(n,r,o,i,e[a+12],6,1700485571),i=fn(i,n,r,o,e[a+3],10,-1894986606),o=fn(o,i,n,r,e[a+10],15,-1051523),r=fn(r,o,i,n,e[a+1],21,-2054922799),n=fn(n,r,o,i,e[a+8],6,1873313359),i=fn(i,n,r,o,e[a+15],10,-30611744),o=fn(o,i,n,r,e[a+6],15,-1560198380),r=fn(r,o,i,n,e[a+13],21,1309151649),n=fn(n,r,o,i,e[a+4],6,-145523070),i=fn(i,n,r,o,e[a+11],10,-1120210379),o=fn(o,i,n,r,e[a+2],15,718787259),r=fn(r,o,i,n,e[a+9],21,-343485551),n=sn(n,s),r=sn(r,c),o=sn(o,u),i=sn(i,l)}return[n,r,o,i]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(an(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))})),mn=pn;function hn(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function vn(e,t){return e<<t|e>>>32-t}var gn=on("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var o=0;o<r.length;++o)e.push(r.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var i=e.length/4+2,a=Math.ceil(i/16),s=new Array(a),c=0;c<a;++c){for(var u=new Uint32Array(16),l=0;l<16;++l)u[l]=e[64*c+4*l]<<24|e[64*c+4*l+1]<<16|e[64*c+4*l+2]<<8|e[64*c+4*l+3];s[c]=u}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(var d=0;d<a;++d){for(var f=new Uint32Array(80),p=0;p<16;++p)f[p]=s[d][p];for(var m=16;m<80;++m)f[m]=vn(f[m-3]^f[m-8]^f[m-14]^f[m-16],1);for(var h=n[0],v=n[1],g=n[2],y=n[3],w=n[4],b=0;b<80;++b){var E=Math.floor(b/20),k=vn(h,5)+hn(E,v,g,y)+w+t[E]+f[b]>>>0;w=y,y=g,g=vn(v,30)>>>0,v=h,h=k}n[0]=n[0]+h>>>0,n[1]=n[1]+v>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+y>>>0,n[4]=n[4]+w>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),yn=gn,wn=Object.freeze({__proto__:null,v1:function(e,t,n){var r=t&&n||0,o=t||new Array(16),i=(e=e||{}).node||Kt,a=void 0!==e.clockseq?e.clockseq:Xt;if(null==i||null==a){var s=e.random||(e.rng||$t)();null==i&&(i=Kt=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=Xt=16383&(s[6]<<8|s[7]))}var c=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:nn+1,l=c-tn+(u-nn)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||c>tn)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");tn=c,nn=u,Xt=a;var d=(1e4*(268435455&(c+=122192928e5))+u)%4294967296;o[r++]=d>>>24&255,o[r++]=d>>>16&255,o[r++]=d>>>8&255,o[r++]=255&d;var f=c/4294967296*1e4&268435455;o[r++]=f>>>8&255,o[r++]=255&f,o[r++]=f>>>24&15|16,o[r++]=f>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var p=0;p<6;++p)o[r+p]=i[p];return t||en(o)},v3:mn,v4:function(e,t,n){var r=(e=e||{}).random||(e.rng||$t)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return en(r)},v5:yn,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!Jt(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)},validate:Jt,stringify:en,parse:rn}),bn=["debug","info","warn","error","none"],En=function(e,t){if(e&&e.destination&&"function"!=typeof e.destination)throw new Error("destination for basicLogger was set to a non-function");function n(e){return function(t){console&&console[e]&&console[e].call(console,t)}}var r=e&&e.destination?[e.destination,e.destination,e.destination,e.destination]:[n("log"),n("info"),n("warn"),n("error")],o=!(!e||!e.destination),i=e&&void 0!==e.prefix&&null!==e.prefix?e.prefix:"[LaunchDarkly] ",a=1;if(e&&e.level)for(var s=0;s<bn.length;s++)bn[s]===e.level&&(a=s);function c(e,n,a){if(!(a.length<1)){var s,c=o?n+": "+i:i;if(1!==a.length&&t){var u=gt(a);u[0]=c+u[0],s=t.apply(void 0,gt(u))}else s=c+a[0];try{r[e](s)}catch(e){console&&console.log&&console.log("[LaunchDarkly] Configured logger's "+n+" method threw an exception: "+e)}}}for(var u={},l=function(e){var t=bn[e];if("none"!==t)if(e<a)u[t]=function(){};else{var n=e;u[t]=function(){c(n,t,arguments)}}},d=0;d<bn.length;d++)l(d);return u},kn=function(e){bn.forEach((function(t){if("none"!==t&&(!e[t]||"function"!=typeof e[t]))throw new Error("Provided logger instance must support logger."+t+"(...) method")}))};function Sn(e){return e&&e.message?e.message:"string"==typeof e||e instanceof String?e:JSON.stringify(e)}var xn=" Please see https://docs.launchdarkly.com/sdk/client-side/javascript#initializing-the-client for instructions on SDK initialization.",Cn={bootstrapInvalid:function(){return"LaunchDarkly bootstrap data is not available because the back end could not read the flags."},bootstrapOldFormat:function(){return"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly."+xn},clientInitialized:function(){return"LaunchDarkly client initialized"},clientNotReady:function(){return"LaunchDarkly client is not ready"},debugEnqueueingEvent:function(e){return'enqueueing "'+e+'" event'},debugPostingDiagnosticEvent:function(e){return"sending diagnostic event ("+e.kind+")"},debugPostingEvents:function(e){return"sending "+e+" events"},debugStreamDelete:function(e){return'received streaming deletion for flag "'+e+'"'},debugStreamDeleteIgnored:function(e){return'received streaming deletion for flag "'+e+'" but ignored due to version check'},debugStreamPatch:function(e){return'received streaming update for flag "'+e+'"'},debugStreamPatchIgnored:function(e){return'received streaming update for flag "'+e+'" but ignored due to version check'},debugStreamPing:function(){return"received ping message from stream"},debugPolling:function(e){return"polling for feature flags at "+e},debugStreamPut:function(){return"received streaming update for all flags"},deprecated:function(e,t){return t?'"'+e+'" is deprecated, please use "'+t+'"':'"'+e+'" is deprecated'},environmentNotFound:function(){return"Environment not found. Double check that you specified a valid environment/client-side ID."+xn},environmentNotSpecified:function(){return"No environment/client-side ID was specified."+xn},errorFetchingFlags:function(e){return"Error fetching flag settings: "+Sn(e)},eventCapacityExceeded:function(){return"Exceeded event queue capacity. Increase capacity to avoid dropping events."},eventWithoutContext:function(){return"Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript"},httpErrorMessage:function(e,t,n){return"Received error "+e+(401===e?" (invalid SDK key)":"")+" for "+t+" - "+(Ot.isHttpErrorRecoverable(e)?n:"giving up permanently")},httpUnavailable:function(){return"Cannot make HTTP requests in this environment."+xn},identifyDisabled:function(){return"identify() has no effect here; it must be called on the main client instance"},inspectorMethodError:function(e,t){return'an inspector: "'.concat(t,'" of type: "').concat(e,'" generated an exception')},invalidContentType:function(e){return'Expected application/json content type but got "'+e+'"'},invalidData:function(){return"Invalid data received from LaunchDarkly; connection may have been interrupted"},invalidInspector:function(e,t){return'an inspector: "'.concat(t,'" of an invalid type (').concat(e,") was configured")},invalidKey:function(){return"Event key must be a string"},invalidContext:function(){return"Invalid context specified."+xn},invalidTagValue:function(e){return'Config option "'.concat(e,'" must only contain letters, numbers, ., _ or -.')},localStorageUnavailable:function(e){return"local storage is unavailable: "+Sn(e)},networkError:function(e){return"network error"+(e?" ("+e+")":"")},optionBelowMinimum:function(e,t,n){return'Config option "'+e+'" was set to '+t+", changing to minimum value of "+n},streamClosing:function(){return"Closing stream connection"},streamConnecting:function(e){return"Opening stream connection to "+e},streamError:function(e,t){return"Error on stream connection: "+Sn(e)+", will continue retrying after "+t+" milliseconds."},tagValueTooLong:function(e){return'Value of "'.concat(e,'" was longer than 64 characters and was discarded.')},unknownCustomEventKey:function(e){return'Custom event "'+e+'" does not exist'},unknownOption:function(e){return'Ignoring unknown config option "'+e+'"'},contextNotSpecified:function(){return"No context specified."+xn},unrecoverableStreamError:function(e){return"Error on stream connection ".concat(Sn(e),", giving up permanently")},wrongOptionType:function(e,t,n){return'Config option "'+e+'" should be of type '+t+", got "+n+", using default value"},wrongOptionTypeBoolean:function(e,t){return'Config option "'+e+'" should be a boolean, got '+t+", converting to boolean"}},_n=kn,An={baseUrl:{default:"https://app.launchdarkly.com"},streamUrl:{default:"https://clientstream.launchdarkly.com"},eventsUrl:{default:"https://events.launchdarkly.com"},sendEvents:{default:!0},streaming:{type:"boolean"},sendLDHeaders:{default:!0},requestHeaderTransform:{type:"function"},sendEventsOnlyForVariation:{default:!1},useReport:{default:!1},evaluationReasons:{default:!1},eventCapacity:{default:100,minimum:1},flushInterval:{default:2e3,minimum:2e3},samplingInterval:{default:0,minimum:0},streamReconnectDelay:{default:1e3,minimum:0},allAttributesPrivate:{default:!1},privateAttributes:{default:[]},bootstrap:{type:"string|object"},diagnosticRecordingInterval:{default:9e5,minimum:2e3},diagnosticOptOut:{default:!1},wrapperName:{type:"string"},wrapperVersion:{type:"string"},stateProvider:{type:"object"},application:{validator:function(e,t,n){var r={};return t.id&&(r.id=Ln("".concat(e,".id"),t.id,n)),t.version&&(r.version=Ln("".concat(e,".version"),t.version,n)),r}},inspectors:{default:[]}},Tn=/^(\w|\.|-)+$/;function On(e){return e&&e.replace(/\/+$/,"")}function Ln(e,t,n){if("string"==typeof t&&t.match(Tn)){if(!(t.length>64))return t;n.warn(Cn.tagValueTooLong(e))}else n.warn(Cn.invalidTagValue(e))}var Fn={baseOptionDefs:An,validate:function(e,t,n,r){var i=qt.extend({logger:{default:r}},An,n),a={};function s(e){qt.onNextTick((function(){t&&t.maybeReportError(new Ot.LDInvalidArgumentError(e))}))}var c=qt.extend({},e||{});return function(e){var t=e;Object.keys(a).forEach((function(e){if(void 0!==t[e]){var n=a[e];r&&r.warn(Cn.deprecated(e,n)),n&&(void 0===t[n]&&(t[n]=t[e]),delete t[e])}}))}(c),c=function(e){var t=qt.extend({},e);return Object.keys(i).forEach((function(e){void 0!==t[e]&&null!==t[e]||(t[e]=i[e]&&i[e].default)})),t}(c),c=function(e){var t=qt.extend({},e),n=function(e){if(null===e)return"any";if(void 0!==e){if(Array.isArray(e))return"array";var t=o(e);return"boolean"===t||"string"===t||"number"===t||"function"===t?t:"object"}};return Object.keys(e).forEach((function(o){var a=e[o];if(null!=a){var c=i[o];if(void 0===c)s(Cn.unknownOption(o));else{var u=c.type||n(c.default),l=c.validator;if(l){var d=l(o,e[o],r);void 0!==d?t[o]=d:delete t[o]}else if("any"!==u){var f=u.split("|"),p=n(a);f.indexOf(p)<0?"boolean"===u?(t[o]=!!a,s(Cn.wrongOptionTypeBoolean(o,p))):(s(Cn.wrongOptionType(o,u,p)),t[o]=c.default):"number"===p&&void 0!==c.minimum&&a<c.minimum&&(s(Cn.optionBelowMinimum(o,a,c.minimum)),t[o]=c.minimum)}}}})),t.baseUrl=On(t.baseUrl),t.streamUrl=On(t.streamUrl),t.eventsUrl=On(t.eventsUrl),t}(c),_n(c.logger),c},getTags:function(e){var t={};return e&&(e.application&&void 0!==e.application.id&&null!==e.application.id&&(t["application-id"]=[e.application.id]),e.application&&void 0!==e.application.version&&null!==e.application.id&&(t["application-version"]=[e.application.version])),t}},Pn=qt.getLDUserAgentString,In=function(e,t){if(t&&!t.sendLDHeaders)return{};var n={};n[e.userAgentHeaderName||"User-Agent"]=Pn(e),t&&t.wrapperName&&(n["X-LaunchDarkly-Wrapper"]=t.wrapperVersion?t.wrapperName+"/"+t.wrapperVersion:t.wrapperName);var r=Fn.getTags(t),o=Object.keys(r);return o.length&&(n["x-launchdarkly-tags"]=o.sort().map((function(e){return Array.isArray(r[e])?r[e].sort().map((function(t){return"".concat(e,"/").concat(t)})):["".concat(e,"/").concat(r[e])]})).reduce((function(e,t){return e.concat(t)}),[]).join(" ")),n},Dn=function(e,t){return t&&t.requestHeaderTransform?t.requestHeaderTransform(Et({},e)):e},Nn=wn.v1,Rn=In,Mn=Dn,jn=function(e,t,n){var r="/a/"+t+".gif",o=qt.extend({"Content-Type":"application/json"},Rn(e,n)),i=e.httpFallbackPing,a={sendChunk:function(t,a,s,c){var u=JSON.stringify(t),l=s?null:Nn();return c?function t(r){var i=s?o:qt.extend({},o,{"X-LaunchDarkly-Event-Schema":"4","X-LaunchDarkly-Payload-ID":l});return e.httpRequest("POST",a,Mn(i,n),u).promise.then((function(e){if(e)return e.status>=400&&Ot.isHttpErrorRecoverable(e.status)&&r?t(!1):function(e){var t={status:e.status},n=e.header("date");if(n){var r=Date.parse(n);r&&(t.serverTime=r)}return t}(e)})).catch((function(){return r?t(!1):Promise.reject()}))}(!0).catch((function(){})):(i&&i(a+r+"?d="+qt.base64URLEncode(u)),Promise.resolve())},sendEvents:function(t,n,r){if(!e.httpRequest)return Promise.resolve();var o,i=e.httpAllowsPost();o=i?[t]:qt.chunkEventsForUrl(2e3-n.length,t);for(var s=[],c=0;c<o.length;c++)s.push(a.sendChunk(o[c],n,r,i));return Promise.all(s)}};return a},Un=En;function Hn(e){return"string"==typeof e&&"kind"!==e&&e.match(/^(\w|\.|-)+$/)}var Wn=function(e,t){if(e){if(t&&(void 0===e.kind||null===e.kind))return void 0!==e.key&&null!==e.key;var n=e.key,r=void 0===e.kind?"user":e.kind,o=Hn(r),i="multi"===r||null!=n&&""!==n;if("multi"===r){var a=Object.keys(e).filter((function(e){return"kind"!==e}));return i&&a.every((function(e){return Hn(e)}))&&a.every((function(t){var n=e[t].key;return null!=n&&""!==n}))}return i&&o}return!1},Bn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Un();if(e){var n={},r=e.kind,o=e.key;switch(r){case void 0:n.user="".concat(o);break;case"multi":Object.entries(e).filter((function(e){return"kind"!==vt(e,1)[0]})).forEach((function(e){var t=vt(e,2),r=t[0],o=t[1];o&&o.key&&(n[r]=o.key)}));break;case null:t.warn("null is not a valid context kind: ".concat(e));break;case"":t.warn("'' is not a valid context kind: ".concat(e));break;default:n[r]="".concat(o)}return n}},Vn=function(e){return e?null===e.kind||void 0===e.kind?["user"]:"multi"!==e.kind?[e.kind]:Object.keys(e).filter((function(e){return"kind"!==e})):[]},zn=Vn,qn=function(){var e={},t=0,n=0,r={},o={};return e.summarizeEvent=function(e){if("feature"===e.kind){var i=e.key+":"+(null!==e.variation&&void 0!==e.variation?e.variation:"")+":"+(null!==e.version&&void 0!==e.version?e.version:""),a=r[i],s=o[e.key];s||(s=new Set,o[e.key]=s),function(e){return e.context?zn(e.context):e.contextKeys?Object.keys(e.contextKeys):[]}(e).forEach((function(e){return s.add(e)})),a?a.count=a.count+1:r[i]={count:1,key:e.key,version:e.version,variation:e.variation,value:e.value,default:e.default},(0===t||e.creationDate<t)&&(t=e.creationDate),e.creationDate>n&&(n=e.creationDate)}},e.getSummary=function(){for(var e={},i=!0,a=0,s=Object.values(r);a<s.length;a++){var c=s[a],u=e[c.key];u||(u={default:c.default,counters:[],contextKinds:gt(o[c.key])},e[c.key]=u);var l={value:c.value,count:c.count};void 0!==c.variation&&null!==c.variation&&(l.variation=c.variation),void 0!==c.version&&null!==c.version?l.version=c.version:l.unknown=!0,u.counters.push(l),i=!1}return i?null:{startDate:t,endDate:n,features:e}},e.clearSummary=function(){t=0,n=0,r={},o={}},e};function Gn(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function $n(e){return(e.startsWith("/")?e.substring(1):e).split("/").map((function(e){return e.indexOf("~")>=0?e.replace(/~1/g,"/").replace(/~0/g,"~"):e}))}function Yn(e){return!e.startsWith("/")}function Jn(e,t){var n=Yn(e),r=Yn(t);if(n&&r)return e===t;if(n){var o=$n(t);return 1===o.length&&e===o[0]}if(r){var i=$n(e);return 1===i.length&&t===i[0]}return e===t}function Kn(e){return"/".concat(Gn(e))}var Xn={cloneExcluding:function(e,t){var n=[],r={},i=[],a=function(){var e=n.pop();if(t.some((function(t){return Jn(t,e.ptr)})))i.push(e.ptr);else{var r=e.source[e.key];if(null===r)e.parent[e.key]=r;else if(Array.isArray(r))e.parent[e.key]=gt(r);else if("object"==o(r)){if(e.visited.includes(r))return"continue";e.parent[e.key]={},n.push.apply(n,gt(Object.keys(r).map((function(t){return{key:t,ptr:(n=e.ptr,o=Gn(t),"".concat(n,"/").concat(o)),source:r,parent:e.parent[e.key],visited:[].concat(gt(e.visited),[r])};var n,o}))))}else e.parent[e.key]=r}};for(n.push.apply(n,gt(Object.keys(e).map((function(t){return{key:t,ptr:Kn(t),source:e,parent:r,visited:[e]}}))));n.length;)a();return{cloned:r,excluded:i.sort()}},compare:Jn,literalToReference:Kn},Qn=function(e){var t={},n=e.allAttributesPrivate,r=e.privateAttributes||[],i=["key","kind","_meta","anonymous"],a=["name","ip","firstName","lastName","email","avatar","country"],s=function(e){if("object"==o(e)&&null!==e&&!Array.isArray(e)){var t=Xn.cloneExcluding(e,function(e){return(n?Object.keys(e):[].concat(gt(r),gt(e._meta&&e._meta.privateAttributes||[]))).filter((function(e){return!i.some((function(t){return Xn.compare(e,t)}))}))}(e)),a=t.cloned,s=t.excluded;return a.key=String(a.key),s.length&&(a._meta||(a._meta={}),a._meta.redactedAttributes=s),a._meta&&(delete a._meta.privateAttributes,0===Object.keys(a._meta).length&&delete a._meta),void 0!==a.anonymous&&(a.anonymous=!!a.anonymous),a}};return t.filter=function(e){return void 0===e.kind||null===e.kind?s(function(e){var t=Et(Et({},e.custom||{}),{},{kind:"user",key:e.key});void 0!==e.anonymous&&(t.anonymous=!!e.anonymous);var n,r=yt(a);try{for(r.s();!(n=r.n()).done;){var o=n.value;delete t[o],void 0!==e[o]&&null!==e[o]&&(t[o]=String(e[o]))}}catch(e){r.e(e)}finally{r.f()}return void 0!==e.privateAttributeNames&&null!==e.privateAttributeNames&&(t._meta=t._meta||{},t._meta.privateAttributes=e.privateAttributeNames.map((function(e){return e.startsWith("/")?Xn.literalToReference(e):e}))),t}(e)):"multi"===e.kind?function(e){for(var t={kind:e.kind},n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];if("kind"!==o){var i=s(e[o]);i&&(t[o]=i)}}return t}(e):s(e)},t},Zn=Bn,er="ready",tr="initialized",nr="failed",rr=qt.appendUrlPath,or=qt.base64URLEncode,ir=qt.objectHasOwnProperty,ar=In,sr=Dn,cr=Ot.isHttpErrorRecoverable,ur=function(e,t,n,r){var o,i=t.streamUrl,a=t.logger,s={},c=rr(i,"/eval/"+n),u=t.useReport,l=t.evaluationReasons,d=t.streamReconnectDelay,f=ar(e,t),p=!1,m=null,h=null,v=null,g=null,y=null,w=0;function b(e){if(e.status&&"number"==typeof e.status&&!cr(e.status))return S(),a.error(Cn.unrecoverableStreamError(e)),void(h&&(clearTimeout(h),h=null));var t=function(){var e,t=(e=function(){var e=d*Math.pow(2,w);return e>3e4?3e4:e}(),e-Math.trunc(.5*Math.random()*e));return w+=1,t}();p||(a.warn(Cn.streamError(e,t)),p=!0),x(!1),S(),E(t)}function E(e){h||(e?h=setTimeout(k,e):k())}function k(){var r;h=null;var s="",d={headers:f,readTimeoutMillis:3e5};if(e.eventSourceFactory){for(var p in null!=g&&(s="h="+g),u?e.eventSourceAllowsReport?(r=c,d.method="REPORT",d.headers["Content-Type"]="application/json",d.body=JSON.stringify(v)):(r=rr(i,"/ping/"+n),s=""):r=c+"/"+or(JSON.stringify(v)),d.headers=sr(d.headers,t),l&&(s=s+(s?"&":"")+"withReasons=true"),r=r+(s?"?":"")+s,S(),a.info(Cn.streamConnecting(r)),o=(new Date).getTime(),m=e.eventSourceFactory(r,d),y)ir(y,p)&&m.addEventListener(p,y[p]);m.onerror=b,m.onopen=function(){w=0}}}function S(){m&&(a.info(Cn.streamClosing()),m.close(),m=null)}function x(e){o&&r&&r.recordStreamInit(o,!e,(new Date).getTime()-o),o=null}return s.connect=function(e,t,n){v=e,g=t,y={};var r=function(e){y[e]=function(t){p=!1,x(!0),n[e]&&n[e](t)}};for(var o in n||{})r(o);E()},s.disconnect=function(){clearTimeout(h),h=null,S()},s.isConnected=function(){return!!(m&&e.eventSourceIsActive&&e.eventSourceIsActive(m))},s},lr=Dn,dr=In,fr="application/json",pr=function(e,t,n){var r=t.baseUrl,o=t.useReport,i=t.evaluationReasons,a=t.logger,s={},c={};function u(n,r){if(!e.httpRequest)return new Promise((function(e,t){t(new Ot.LDFlagFetchError(Cn.httpUnavailable()))}));var o=r?"REPORT":"GET",i=dr(e,t);r&&(i["Content-Type"]=fr);var a=c[n];a||(a=function(e){var t,n,r,o,i={addPromise:function(i,a){t=i,n&&n(),n=a,i.then((function(n){t===i&&(r(n),e&&e())}),(function(n){t===i&&(o(n),e&&e())}))}};return i.resultPromise=new Promise((function(e,t){r=e,o=t})),i}((function(){delete c[n]})),c[n]=a);var s=e.httpRequest(o,n,lr(i,t),r),u=s.promise.then((function(e){if(200===e.status){if(e.header("content-type")&&e.header("content-type").substring(0,16)===fr)return JSON.parse(e.body);var t=Cn.invalidContentType(e.header("content-type")||"");return Promise.reject(new Ot.LDFlagFetchError(t))}return Promise.reject(function(e){return 404===e.status?new Ot.LDInvalidEnvironmentIdError(Cn.environmentNotFound()):new Ot.LDFlagFetchError(Cn.errorFetchingFlags(e.statusText||String(e.status)))}(e))}),(function(e){return Promise.reject(new Ot.LDFlagFetchError(Cn.networkError(e)))}));return a.addPromise(u,(function(){s.cancel&&s.cancel()})),a.resultPromise}return s.fetchJSON=function(e){return u(qt.appendUrlPath(r,e),null)},s.fetchFlagSettings=function(e,t){var s,c,l,d="";return o?(c=[r,"/sdk/evalx/",n,"/context"].join(""),l=JSON.stringify(e)):(s=qt.base64URLEncode(JSON.stringify(e)),c=[r,"/sdk/evalx/",n,"/contexts/",s].join("")),t&&(d="h="+t),i&&(d=d+(d?"&":"")+"withReasons=true"),c=c+(d?"?":"")+d,a.debug(Cn.debugPolling(c)),u(c,l)},s},mr=wn.v1,hr=Vn,vr=function(e){function t(e){return null==e||"user"===e?"ld:$anonUserId":"ld:$contextKey:".concat(e)}function n(n,r){return null!==r.key&&void 0!==r.key?(r.key=r.key.toString(),Promise.resolve(r)):r.anonymous?function(n){return e.get(t(n))}(n).then((function(o){if(o)return r.key=o,r;var i=mr();return r.key=i,function(n,r){return e.set(t(r),n)}(i,n).then((function(){return r}))})):Promise.reject(new Ot.LDInvalidUserError(Cn.invalidContext()))}this.processContext=function(e){if(!e)return Promise.reject(new Ot.LDInvalidUserError(Cn.contextNotSpecified()));var t=qt.clone(e);if("multi"===e.kind){var r=hr(t);return Promise.all(r.map((function(e){return n(e,t[e])}))).then((function(){return t}))}return n(e.kind,t)}},gr=wn.v1,yr=Fn.baseOptionDefs,wr=qt.appendUrlPath,br=function(e){var t={diagnosticId:gr()};return e&&(t.sdkKeySuffix=e.length>6?e.substring(e.length-6):e),t},Er=function(e){var t,n,r,o;function i(e){t=e,n=0,r=0,o=[]}return i(e),{getProps:function(){return{dataSinceDate:t,droppedEvents:n,eventsInLastBatch:r,streamInits:o}},setProps:function(e){t=e.dataSinceDate,n=e.droppedEvents||0,r=e.eventsInLastBatch||0,o=e.streamInits||[]},incrementDroppedEvents:function(){n++},setEventsInLastBatch:function(e){r=e},recordStreamInit:function(e,t,n){var r={timestamp:e,failed:t,durationMillis:n};o.push(r)},reset:i}},kr=function(e,t,n,r,o,i,a){var s,c,u=!!e.diagnosticUseCombinedEvent,l="ld:"+o+":$diagnostics",d=wr(i.eventsUrl,"/events/diagnostic/"+o),f=i.diagnosticRecordingInterval,p=n,m=!!i.streaming,h={};function v(){return{sdk:w(),configuration:{customBaseURI:i.baseUrl!==yr.baseUrl.default,customStreamURI:i.streamUrl!==yr.streamUrl.default,customEventsURI:i.eventsUrl!==yr.eventsUrl.default,eventsCapacity:i.eventCapacity,eventsFlushIntervalMillis:i.flushInterval,reconnectTimeMillis:i.streamReconnectDelay,streamingDisabled:!m,allAttributesPrivate:!!i.allAttributesPrivate,diagnosticRecordingIntervalMillis:i.diagnosticRecordingInterval,usingSecureMode:!!i.hash,bootstrapMode:!!i.bootstrap,fetchGoalsDisabled:!i.fetchGoals,sendEventsOnlyForVariation:!!i.sendEventsOnlyForVariation},platform:e.diagnosticPlatformData}}function g(e){i.logger&&i.logger.debug(Cn.debugPostingDiagnosticEvent(e)),r.sendEvents(e,d,!0).then((function(){})).catch((function(){}))}function y(){g(function(){var e=(new Date).getTime(),t=Et({kind:u?"diagnostic-combined":"diagnostic",id:a,creationDate:e},p.getProps());return u&&(t=Et(Et({},t),v())),p.reset(e),t}()),c=setTimeout(y,f),s=(new Date).getTime(),u&&function(){if(t.isEnabled()){var e=Et({},p.getProps());t.set(l,JSON.stringify(e))}}()}function w(){var t=Et({},e.diagnosticSdkData);return i.wrapperName&&(t.wrapperName=i.wrapperName),i.wrapperVersion&&(t.wrapperVersion=i.wrapperVersion),t}return h.start=function(){u?function(e){if(!t.isEnabled())return e(!1);t.get(l).then((function(t){if(t)try{var n=JSON.parse(t);p.setProps(n),s=n.dataSinceDate}catch(e){}e(!0)})).catch((function(){e(!1)}))}((function(e){if(e){var t=(s||0)+f,n=(new Date).getTime();n>=t?y():c=setTimeout(y,t-n)}else 0===Math.floor(4*Math.random())?y():c=setTimeout(y,f)})):(g(Et({kind:"diagnostic-init",id:a,creationDate:p.getProps().dataSinceDate},v())),c=setTimeout(y,f))},h.stop=function(){c&&clearTimeout(c)},h.setStreaming=function(e){m=e},h},Sr=qt.onNextTick,xr={flagUsed:"flag-used",flagDetailsChanged:"flag-details-changed",flagDetailChanged:"flag-detail-changed",clientIdentityChanged:"client-identity-changed"};Object.freeze(xr);var Cr=function(e,t){var n,o={},i=(r(n={},xr.flagUsed,[]),r(n,xr.flagDetailsChanged,[]),r(n,xr.flagDetailChanged,[]),r(n,xr.clientIdentityChanged,[]),n),a=e&&e.map((function(e){return function(e,t){var n=!1,r={type:e.type,name:e.name,method:function(){try{e.method.apply(e,arguments)}catch(e){n||(n=!0,t.warn(Cn.inspectorMethodError(r.type,r.name)))}}};return r}(e,t)}));return a&&a.forEach((function(e){Object.prototype.hasOwnProperty.call(i,e.type)?i[e.type].push(e):t.warn(Cn.invalidInspector(e.type,e.name))})),o.hasListeners=function(e){return i[e]&&i[e].length},o.onFlagUsed=function(e,t,n){i[xr.flagUsed].length&&Sr((function(){i[xr.flagUsed].forEach((function(r){return r.method(e,t,n)}))}))},o.onFlags=function(e){i[xr.flagDetailsChanged].length&&Sr((function(){i[xr.flagDetailsChanged].forEach((function(t){return t.method(e)}))}))},o.onFlagChanged=function(e,t){i[xr.flagDetailChanged].length&&Sr((function(){i[xr.flagDetailChanged].forEach((function(n){return n.method(e,t)}))}))},o.onIdentityChanged=function(e){i[xr.clientIdentityChanged].length&&Sr((function(){i[xr.clientIdentityChanged].forEach((function(t){return t.method(e)}))}))},o},_r=En,Ar=Wn,Tr=xr,Or=Cr,Lr="change",Fr="internal-change",Pr={initialize:function(e,t,n,r,i){var a,s,c,u=n&&n.logger?n.logger:i&&i.logger&&i.logger.default||_r("warn"),l=function(e){var t={},n={};return t.on=function(e,t,r){n[e]=n[e]||[],n[e]=n[e].concat({handler:t,context:r})},t.off=function(e,t,r){if(n[e])for(var o=0;o<n[e].length;o++)n[e][o].handler===t&&n[e][o].context===r&&(n[e]=n[e].slice(0,o).concat(n[e].slice(o+1)))},t.emit=function(e){if(n[e])for(var t=n[e].slice(0),r=0;r<t.length;r++)t[r].handler.apply(t[r].context,Array.prototype.slice.call(arguments,1))},t.getEvents=function(){return Object.keys(n)},t.getEventListenerCount=function(e){return n[e]?n[e].length:0},t.maybeReportError=function(t){t&&(n.error?this.emit("error",t):(e||console).error(t.message))},t}(u),d=function(e){var t=!1,n=!1,r=null,o=null,i=new Promise((function(t){e.on(er,(function n(){e.off(er,n),t()}))})).catch((function(){}));return{getInitializationPromise:function(){return o||(t?Promise.resolve():n?Promise.reject(r):(o=new Promise((function(t,n){e.on(tr,(function n(){e.off(tr,n),t()})),e.on(nr,(function t(r){e.off(nr,t),n(r)}))})),o))},getReadyPromise:function(){return i},signalSuccess:function(){t||n||(t=!0,e.emit(tr),e.emit(er))},signalFailure:function(o){t||n||(n=!0,r=o,e.emit(nr,o),e.emit(er)),e.maybeReportError(o)}}}(l),f=Fn.validate(n,l,i,u),p=Or(f.inspectors,u),m=f.sendEvents,h=e,v=f.hash,g=function(e,t){var n={},r=!1,o=function(e){r||(r=!0,t.warn(Cn.localStorageUnavailable(e)))};return n.isEnabled=function(){return!!e},n.get=function(t){return new Promise((function(n){e?e.get(t).then(n).catch((function(e){o(e),n(void 0)})):n(void 0)}))},n.set=function(t,n){return new Promise((function(r){e?e.set(t,n).then((function(){return r(!0)})).catch((function(e){o(e),r(!1)})):r(!1)}))},n.clear=function(t){return new Promise((function(n){e?e.clear(t).then((function(){return n(!0)})).catch((function(e){o(e),n(!1)})):n(!1)}))},n}(r.localStorage,u),y=jn(r,h,f),w=f.sendEvents&&!f.diagnosticOptOut,b=w?br(h):null,E=w?Er((new Date).getTime()):null,k=w?kr(r,g,E,y,h,f,b):null,S=ur(r,f,h,E),x=f.eventProcessor||function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a={},s=(arguments.length>5&&void 0!==arguments[5]?arguments[5]:null)||jn(e,n,t),c=qt.appendUrlPath(t.eventsUrl,"/events/bulk/"+n),u=qn(),l=Qn(t),d=t.samplingInterval,f=t.eventCapacity,p=t.flushInterval,m=t.logger,h=[],v=0,g=!1,y=!1;function w(){return 0===d||0===Math.floor(Math.random()*d)}function b(e){var t=qt.extend({},e);return"identify"===e.kind?t.context=l.filter(e.context):(t.contextKeys=Zn(e.context,m),delete t.context),"feature"===e.kind&&(delete t.trackEvents,delete t.debugEventsUntilDate),t}function E(e){h.length<f?(h.push(e),y=!1):(y||(y=!0,m.warn(Cn.eventCapacityExceeded())),o&&o.incrementDroppedEvents())}return a.enqueue=function(e){if(!g){var t,n=!1,r=!1;if(u.summarizeEvent(e),"feature"===e.kind?w()&&(n=!!e.trackEvents,r=!!(t=e).debugEventsUntilDate&&t.debugEventsUntilDate>v&&t.debugEventsUntilDate>(new Date).getTime()):n=w(),n&&E(b(e)),r){var o=qt.extend({},e,{kind:"debug"});o.context=l.filter(o.context),delete o.trackEvents,delete o.debugEventsUntilDate,E(o)}}},a.flush=function(){if(g)return Promise.resolve();var e=h,t=u.getSummary();return u.clearSummary(),t&&(t.kind="summary",e.push(t)),o&&o.setEventsInLastBatch(e.length),0===e.length?Promise.resolve():(h=[],m.debug(Cn.debugPostingEvents(e.length)),s.sendEvents(e,c).then((function(e){var t=e&&e[0];t&&(t.serverTime&&(v=t.serverTime),Ot.isHttpErrorRecoverable(t.status)||(g=!0),t.status>=400&&qt.onNextTick((function(){i.maybeReportError(new Ot.LDUnexpectedResponseError(Cn.httpErrorMessage(t.status,"event posting","some events were dropped")))})))})))},a.start=function(){r=setTimeout((function e(){a.flush(),r=setTimeout(e,p)}),p)},a.stop=function(){clearTimeout(r)},a}(r,f,h,E,l,y),C=pr(r,f,h),_={},A=f.streaming,T=!1,O=!1,L=!0,F=f.stateProvider,P=function(e,t){var n,r={};return r.setContext=function(e){(n=qt.sanitizeContext(e))&&t&&t(qt.clone(n))},r.getContext=function(){return n?qt.clone(n):null},e&&r.setContext(e),r}(null,(function(e){(function(e){F||e&&N({kind:"identify",context:e,creationDate:(new Date).getTime()})})(e),p.hasListeners(Tr.clientIdentityChanged)&&p.onIdentityChanged(P.getContext())})),I=new vr(g),D=g.isEnabled()?function(e,t,n,r){var o={};function i(){var e="",o=r.getContext();return o&&(e=n||qt.btoa(JSON.stringify(o))),"ld:"+t+":"+e}return o.loadFlags=function(){return e.get(i()).then((function(e){if(null==e)return null;try{var t=JSON.parse(e);if(t){var n=t.$schema;void 0===n||n<1?t=qt.transformValuesToVersionedValues(t):delete t.$schema}return t}catch(e){return o.clearFlags().then((function(){return null}))}}))},o.saveFlags=function(t){var n=qt.extend({},t,{$schema:1});return e.set(i(),JSON.stringify(n))},o.clearFlags=function(){return e.clear(i())},o}(g,h,v,P):null;function N(e){h&&(F&&F.enqueueEvent&&F.enqueueEvent(e)||(e.context?(L=!1,!m||O||r.isDoNotTrack()||(u.debug(Cn.debugEnqueueingEvent(e.kind)),x.enqueue(e))):L&&(u.warn(Cn.eventWithoutContext()),L=!1)))}function R(e,t){p.hasListeners(Tr.flagDetailChanged)&&p.onFlagChanged(e.key,W(t))}function M(){p.hasListeners(Tr.flagDetailsChanged)&&p.onFlags(Object.entries(_).map((function(e){var t=vt(e,2);return{key:t[0],detail:W(t[1])}})).reduce((function(e,t){return e[t.key]=t.detail,e}),{}))}function j(e,t,n,r){var o=P.getContext(),i=new Date,a={kind:"feature",key:e,context:o,value:t?t.value:null,variation:t?t.variationIndex:null,default:n,creationDate:i.getTime()},s=_[e];s&&(a.version=s.flagVersion?s.flagVersion:s.version,a.trackEvents=s.trackEvents,a.debugEventsUntilDate=s.debugEventsUntilDate),(r||s&&s.trackReason)&&t&&(a.reason=t.reason),N(a)}function U(e){return Ar(e,!1)?Promise.resolve(e):Promise.reject(new Ot.LDInvalidUserError(Cn.invalidContext()))}function H(e,t,n,r,o){var i;if(_&&qt.objectHasOwnProperty(_,e)&&_[e]&&!_[e].deleted){var a=_[e];i=W(a),null!==a.value&&void 0!==a.value||(i.value=t)}else i={value:t,variationIndex:null,reason:{kind:"ERROR",errorKind:"FLAG_NOT_FOUND"}};return n&&j(e,i,t,r),o||function(e,t){p.hasListeners(Tr.flagUsed)&&p.onFlagUsed(e,t,P.getContext())}(e,i),i}function W(e){return{value:e.value,variationIndex:void 0===e.variation?null:e.variation,reason:e.reason||null}}function B(){if(s=!0,P.getContext()){var e=function(e){try{return JSON.parse(e)}catch(e){return void l.maybeReportError(new Ot.LDInvalidDataError(Cn.invalidData()))}};S.connect(P.getContext(),v,{ping:function(){u.debug(Cn.debugStreamPing());var e=P.getContext();C.fetchFlagSettings(e,v).then((function(t){qt.deepEquals(e,P.getContext())&&z(t||{})})).catch((function(e){l.maybeReportError(new Ot.LDFlagFetchError(Cn.errorFetchingFlags(e)))}))},put:function(t){var n=e(t.data);n&&(u.debug(Cn.debugStreamPut()),z(n))},patch:function(t){var n=e(t.data);if(n){var r=_[n.key];if(!r||!r.version||!n.version||r.version<n.version){u.debug(Cn.debugStreamPatch(n.key));var o={},i=qt.extend({},n);delete i.key,_[n.key]=i;var a=W(i);o[n.key]=r?{previous:r.value,current:a}:{current:a},q(o),R(n,i)}else u.debug(Cn.debugStreamPatchIgnored(n.key))}},delete:function(t){var n=e(t.data);if(n)if(!_[n.key]||_[n.key].version<n.version){u.debug(Cn.debugStreamDelete(n.key));var r={};_[n.key]&&!_[n.key].deleted&&(r[n.key]={previous:_[n.key].value}),_[n.key]={version:n.version,deleted:!0},R(n,_[n.key]),q(r)}else u.debug(Cn.debugStreamDeleteIgnored(n.key))}})}}function V(){s&&(S.disconnect(),s=!1)}function z(e){var t={};if(!e)return Promise.resolve();for(var n in _)qt.objectHasOwnProperty(_,n)&&_[n]&&(e[n]&&!qt.deepEquals(e[n].value,_[n].value)?t[n]={previous:_[n].value,current:W(e[n])}:e[n]&&!e[n].deleted||(t[n]={previous:_[n].value}));for(var r in e)qt.objectHasOwnProperty(e,r)&&e[r]&&(!_[r]||_[r].deleted)&&(t[r]={current:W(e[r])});return _=Et({},e),M(),q(t).catch((function(){}))}function q(e){var t=Object.keys(e);if(t.length>0){var n={};t.forEach((function(t){var r=e[t].current,o=r?r.value:void 0,i=e[t].previous;l.emit(Lr+":"+t,o,i),n[t]=r?{current:o,previous:i}:{previous:i}})),l.emit(Lr,n),l.emit(Fr,_),f.sendEventsOnlyForVariation||F||t.forEach((function(t){j(t,e[t].current)}))}return a&&D?D.saveFlags(_):Promise.resolve()}function G(){var e=A||c&&void 0===A;e&&!s?B():!e&&s&&V(),k&&k.setStreaming(e)}function $(e){return e===Lr||e.substr(0,7)===Lr+":"}if("string"==typeof f.bootstrap&&"LOCALSTORAGE"===f.bootstrap.toUpperCase()&&(D?a=!0:u.warn(Cn.localStorageUnavailable())),"object"==o(f.bootstrap)&&(_=function(e){var t=Object.keys(e),n="$flagsState",r="$valid",o=e[n];!o&&t.length&&u.warn(Cn.bootstrapOldFormat()),!1===e[r]&&u.warn(Cn.bootstrapInvalid());var i={};return t.forEach((function(t){if(t!==n&&t!==r){var a={value:e[t]};o&&o[t]?a=qt.extend(a,o[t]):a.version=0,i[t]=a}})),i}(f.bootstrap)),F){var Y=F.getInitialState();Y?J(Y):F.on("init",J),F.on("update",(function(e){e.context&&P.setContext(e.context),e.flags&&z(e.flags)}))}else(e?I.processContext(t).then(U).then((function(e){return P.setContext(e),"object"==o(f.bootstrap)?K():a?D.loadFlags().then((function(e){return null==e?(_={},C.fetchFlagSettings(P.getContext(),v).then((function(e){return z(e||{})})).then(K).catch((function(e){X(new Ot.LDFlagFetchError(Cn.errorFetchingFlags(e)))}))):(_=e,qt.onNextTick(K),C.fetchFlagSettings(P.getContext(),v).then((function(e){return z(e)})).catch((function(e){return l.maybeReportError(e)})))})):C.fetchFlagSettings(P.getContext(),v).then((function(e){_=e||{},M(),K()})).catch((function(e){_={},X(e)}))})):Promise.reject(new Ot.LDInvalidEnvironmentIdError(Cn.environmentNotSpecified()))).catch(X);function J(e){h=e.environment,P.setContext(e.context),_=Et({},e.flags),qt.onNextTick(K)}function K(){u.info(Cn.clientInitialized()),T=!0,G(),d.signalSuccess()}function X(e){d.signalFailure(e)}var Q={waitForInitialization:function(){return d.getInitializationPromise()},waitUntilReady:function(){return d.getReadyPromise()},identify:function(e,t,n){if(O)return qt.wrapPromiseCallback(Promise.resolve({}),n);if(F)return u.warn(Cn.identifyDisabled()),qt.wrapPromiseCallback(Promise.resolve(qt.transformVersionedValuesToValues(_)),n);var r=a&&D?D.clearFlags():Promise.resolve();return qt.wrapPromiseCallback(r.then((function(){return I.processContext(e)})).then(U).then((function(e){return C.fetchFlagSettings(e,t).then((function(n){var r=qt.transformVersionedValuesToValues(n);return P.setContext(e),v=t,n?z(n).then((function(){return r})):r}))})).then((function(e){return s&&B(),e})).catch((function(e){return l.maybeReportError(e),Promise.reject(e)})),n)},getContext:function(){return P.getContext()},variation:function(e,t){return H(e,t,!0,!1,!1).value},variationDetail:function(e,t){return H(e,t,!0,!0,!1)},track:function(e,t,n){if("string"==typeof e){r.customEventFilter&&!r.customEventFilter(e)&&u.warn(Cn.unknownCustomEventKey(e));var o=P.getContext(),i={kind:"custom",key:e,context:o,url:r.getCurrentUrl(),creationDate:(new Date).getTime()};o&&o.anonymous&&(i.contextKind=o.anonymous?"anonymousUser":"user"),null!=t&&(i.data=t),null!=n&&(i.metricValue=n),N(i)}else l.maybeReportError(new Ot.LDInvalidEventKeyError(Cn.unknownCustomEventKey(e)))},on:function(e,t,n){$(e)?(c=!0,T&&G(),l.on(e,t,n)):l.on.apply(l,arguments)},off:function(e){if(l.off.apply(l,arguments),$(e)){var t=!1;l.getEvents().forEach((function(e){$(e)&&l.getEventListenerCount(e)>0&&(t=!0)})),t||(c=!1,s&&void 0===A&&V())}},setStreaming:function(e){var t=null===e?void 0:e;t!==A&&(A=t,G())},flush:function(e){return qt.wrapPromiseCallback(m?x.flush():Promise.resolve(),e)},allFlags:function(){var e={};if(!_)return e;for(var t in _)qt.objectHasOwnProperty(_,t)&&!_[t].deleted&&(e[t]=H(t,null,!f.sendEventsOnlyForVariation,!1,!0).value);return e},close:function(e){if(O)return qt.wrapPromiseCallback(Promise.resolve(),e);var t=function(){O=!0,_={}},n=Promise.resolve().then((function(){if(V(),k&&k.stop(),m)return x.stop(),x.flush()})).then(t).catch(t);return qt.wrapPromiseCallback(n,e)}};return{client:Q,options:f,emitter:l,ident:P,logger:u,requestor:C,start:function(){m&&(k&&k.start(),x.start())},enqueueEvent:N,getFlagsInternal:function(){return _},getEnvironmentId:function(){return h},internalChangeEventName:Fr}},commonBasicLogger:_r,errors:Ot,messages:Cn,utils:qt,getContextKeys:Bn},Ir=Pr.initialize,Dr=Pr.errors;function Nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nr(Object(n),!0).forEach((function(t){Mr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==o(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jr={promise:Promise.resolve({status:200,header:function(){return null},body:null})};function Ur(e,t,n,r,o){if(o&&!function(){var e=window.navigator&&window.navigator.userAgent;if(e){var t=e.match(/Chrom(e|ium)\/([0-9]+)\./);if(t)return parseInt(t[2],10)<73}return!0}())return jr;var i=new window.XMLHttpRequest;for(var a in i.open(e,t,!o),n||{})Object.prototype.hasOwnProperty.call(n,a)&&i.setRequestHeader(a,n[a]);if(o){try{i.send(r)}catch(e){}return jr}var s,c=new Promise((function(e,t){i.addEventListener("load",(function(){s||e({status:i.status,header:function(e){return i.getResponseHeader(e)},body:i.responseText})})),i.addEventListener("error",(function(){s||t(new Error)})),i.send(r)}));return{promise:c,cancel:function(){s=!0,i.abort()}}}var Hr=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")};function Wr(e,t,n,r){var o,i,a=("substring"!==e.kind&&"regex"!==e.kind||!r.includes("/")?t.replace(r,""):t).replace(n,"");switch(e.kind){case"exact":i=t,o=new RegExp("^"+Hr(e.url)+"/?$");break;case"canonical":i=a,o=new RegExp("^"+Hr(e.url)+"/?$");break;case"substring":i=a,o=new RegExp(".*"+Hr(e.substring)+".*$");break;case"regex":i=a,o=new RegExp(e.pattern);break;default:return!1}return o.test(i)}function Br(e,t){for(var n={},r=null,o=[],i=0;i<e.length;i++)for(var a=e[i],s=a.urls||[],c=0;c<s.length;c++)if(Wr(s[c],window.location.href,window.location.search,window.location.hash)){"pageview"===a.kind?t("pageview",a):(o.push(a),t("click_pageview",a));break}return o.length>0&&(r=function(e){for(var n=function(e,t){for(var n=[],r=0;r<t.length;r++)for(var o=e.target,i=t[r],a=i.selector,s=document.querySelectorAll(a);o&&s.length>0;){for(var c=0;c<s.length;c++)o===s[c]&&n.push(i);o=o.parentNode}return n}(e,o),r=0;r<n.length;r++)t("click",n[r])},document.addEventListener("click",r)),n.dispose=function(){document.removeEventListener("click",r)},n}function Vr(e,t){var n,r;function o(){r&&r.dispose(),n&&n.length&&(r=Br(n,i))}function i(t,n){var r=e.ident.getContext(),o={kind:t,key:n.key,data:null,url:window.location.href,creationDate:(new Date).getTime(),context:r};return"click"===t&&(o.selector=n.selector),e.enqueueEvent(o)}return e.requestor.fetchJSON("/sdk/goals/"+e.getEnvironmentId()).then((function(e){e&&e.length>0&&(r=Br(n=e,i),function(e,t){var n,r=window.location.href;function o(){(n=window.location.href)!==r&&(r=n,t())}!function e(t,n){t(),setTimeout((function(){e(t,n)}),n)}(o,300),window.history&&window.history.pushState?window.addEventListener("popstate",o):window.addEventListener("hashchange",o)}(0,o)),t()})).catch((function(n){e.emitter.maybeReportError(new Dr.LDUnexpectedResponseError((n&&n.message,n.message))),t()})),{}}var zr="goalsReady",qr={fetchGoals:{default:!0},hash:{type:"string"},eventProcessor:{type:"object"},eventUrlTransformer:{type:"function"},disableSyncEventPost:{default:!1}};var Gr=function(e){return new Promise((function(t){var n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(e){var t,n={userAgentHeaderName:"X-LaunchDarkly-User-Agent",synchronousFlush:!1};if(window.XMLHttpRequest){var r=e&&e.disableSyncEventPost;n.httpRequest=function(e,t,o,i){var a=n.synchronousFlush&!r;return n.synchronousFlush=!1,Ur(e,t,o,i,a)}}n.httpAllowsPost=function(){return void 0===t&&(t=!!window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest),t},n.httpFallbackPing=function(e){(new window.Image).src=e};var o,i=e&&e.eventUrlTransformer;n.getCurrentUrl=function(){return i?i(window.location.href):window.location.href},n.isDoNotTrack=function(){var e;return 1===(e=window.navigator&&void 0!==window.navigator.doNotTrack?window.navigator.doNotTrack:window.navigator&&void 0!==window.navigator.msDoNotTrack?window.navigator.msDoNotTrack:window.doNotTrack)||!0===e||"1"===e||"yes"===e};try{window.localStorage&&(n.localStorage={get:function(e){return new Promise((function(t){t(window.localStorage.getItem(e))}))},set:function(e,t){return new Promise((function(n){window.localStorage.setItem(e,t),n()}))},clear:function(e){return new Promise((function(t){window.localStorage.removeItem(e),t()}))}})}catch(e){n.localStorage=null}if(e&&e.useReport&&"function"==typeof window.EventSourcePolyfill&&window.EventSourcePolyfill.supportedOptions&&window.EventSourcePolyfill.supportedOptions.method?(n.eventSourceAllowsReport=!0,o=window.EventSourcePolyfill):(n.eventSourceAllowsReport=!1,o=window.EventSource),window.EventSource){var a=3e5;n.eventSourceFactory=function(e,t){var n=Rr(Rr({},{heartbeatTimeout:a,silentTimeout:a,skipDefaultHeaders:!0}),t);return new o(e,n)},n.eventSourceIsActive=function(e){return e.readyState===window.EventSource.OPEN||e.readyState===window.EventSource.CONNECTING}}return n.userAgent="JSClient",n.version="3.1.4",n.diagnosticSdkData={name:"js-client-sdk",version:"3.1.4"},n.diagnosticPlatformData={name:"JS"},n.diagnosticUseCombinedEvent=!0,n}(n),o=Ir(e,t,n,r,qr),i=o.client,a=o.options,s=o.emitter,c=new Promise((function(e){var t=s.on(zr,(function(){s.off(zr,t),e()}))}));i.waitUntilGoalsReady=function(){return c},a.fetchGoals?Vr(o,(function(){return s.emit(zr)})):s.emit(zr),"complete"!==document.readyState?window.addEventListener("load",o.start):o.start();var u=function(){r.synchronousFlush=!0,i.flush().catch((function(){})),r.synchronousFlush=!1};return document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&u()})),window.addEventListener("pagehide",u),i}("60b9052b1c33140e34a9dd65",{kind:"user",key:e,environment:"sandbox"},{flushInterval:9e5});n.waitForInitialization().then((function(){t({ldClient:n,allFlags:n.allFlags()})})).catch((function(){t()}))}))},$r="SET_SIZE",Yr="CHAT_HIDE",Jr="CHAT_SHOW",Kr="SET_SURVEY_ENABLED",Xr="CHAT_TOGGLE_SURVEY",Qr="BOOT_FINISHED",Zr="CHAT_RESTARTED",eo="CHAT_ENDED",to="SETUP_COMPLETED",no="SET_BODY_OVERLAY",ro="MESSAGE_RECEIVED",oo="REDIRECTING_USER",io="SET_IFRAME_TITLE",ao="ADD_ARIA_LIVE",so="ARIA_LIVE_STATUS",co="UPDATE_WRAPPER_STYLES",uo="FIRST_MESSAGE_RECEIVED",lo="APP_MOUNT",fo={exports:{}};function po(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?po(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):po(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,i||e,a),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,o,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,i),!0;case 6:return l.fn.call(l.context,t,r,o,i,a),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var f,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,o);break;default:if(!c)for(f=1,c=new Array(d-1);f<d;f++)c[f-1]=arguments[f];l[u].fn.apply(l[u].context,c)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||o&&!s.once||r&&s.context!==r||a(this,i);else{for(var c=0,u=[],l=s.length;c<l;c++)(s[c].fn!==t||o&&!s[c].once||r&&s[c].context!==r)&&u.push(s[c]);u.length?this._events[i]=1===u.length?u[0]:u:a(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(fo);var ho=function(){var e=new fo.exports.EventEmitter,t=function(e){return function(t){if(t&&t.data&&t.data.type)switch(t.data.type){case $r:e.emit($r,mo({},t.data.payload));break;case co:e.emit(co,mo({},t.data.payload));break;case Yr:e.emit(Yr);break;case Jr:e.emit(Jr);break;case Qr:e.emit(Qr);break;case Zr:e.emit(Zr);break;case eo:e.emit(eo);break;case to:e.emit(to);break;case Xr:e.emit(Xr,mo({},t.data.payload));break;case Kr:e.emit(Kr);break;case no:e.emit(no,mo({},t.data.payload));break;case ro:e.emit(ro,mo({},t.data.payload));break;case oo:e.emit(oo,mo({},t.data.payload));break;case io:e.emit(io,mo({},t.data.payload));break;case ao:e.emit(ao,mo({},t.data.payload));break;case so:e.emit(so,mo({},t.data.payload));break;case uo:e.emit(uo,mo({},t.data.payload));break;case lo:e.emit(lo,mo({},t.data.payload))}}}(e);return window.addEventListener("message",t,!1),e},vo="pypestream-iframe",go="pypestream-wrapper",yo={interval:null,originalTitle:document.title,On:function(e){yo.interval=setInterval((function(){document.title=yo.originalTitle==document.title?e:yo.originalTitle}),1e3)},Off:function(){document.title=yo.originalTitle,clearInterval(yo.interval),yo.interval=null}};function wo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wo(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e,o){var i=function(){function i(){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r(this,"config",(function(e){n.state.pypestreamConfig=bo(bo({},n.state.pypestreamConfig),e)})),r(this,"boot",(function(e,t){console.time("total_time_taken_to_complete_setup"),console.time("total_time_taken_for_first_message"),console.time("total_time_taken_for_app_mount"),null==e.APP_ID&&console.error("You must provide an APP_ID string in the config object."),n.config(e),n.state.isConfigured=!0,"window"===n.state.pypestreamConfig.displayMode&&n.state.dom.window&&n.focusWindow(n.state.dom.window),n.state.hasBooted?n.state.isShowing||n.show():(void 0!==t&&(n.state.pypestreamConfig.displayMode="inline"),n.startChat(t),n.state.hasBooted=!0)})),r(this,"show",(function(){n.pe19356_FF&&n.toggleInlineAppLoader({show:!0}),n.debug("Pypestream.show()"),n.state.isConfigured&&n.state.hasBooted?"window"!==n.state.pypestreamConfig.displayMode?n.state.isShowing?n.debug("Already showing."):n.postShowChat():n.warn("Cannot show chat in display mode 'window'."):n.warn("You must call Pypestream.boot() before 'show'.")})),r(this,"hide",(function(){n.pe19356_FF&&n.toggleInlineAppLoader({show:!1}),n.debug("Pypestream.hide()"),n.state.isConfigured&&n.state.hasBooted?"window"!==n.state.pypestreamConfig.displayMode?n.state.isShowing?n.postHideChat():n.debug("Already hiding."):n.warn("Cannot hide chat in display mode 'window'."):n.warn("You must call Pypestream.boot() before 'hide'.")})),r(this,"toggle",(function(){n.debug("Pypestream.toggle()"),n.state.isConfigured&&n.state.hasBooted?"window"!==n.state.pypestreamConfig.displayMode?n.state.isShowing?n.hide():n.show():n.warn("Cannot toggle chat in display mode 'window'."):n.warn("You must call Pypestream.boot() before 'toggle'.")})),r(this,"shutdown",(function(){var e,t;if(n.state.isConfigured&&n.state.hasBooted){B(),n.state.hasBooted=!1,function(e){try{localStorage.removeItem(e)}catch(e){}}("pypestream-chat-visible"),n.pe16380_FF&&(null===(e=n.state.dom.iframe)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage({type:"SHUT_DOWN"},"*"));var r=!!n.state.currentlyRedirecting;(!n.pe18296_FF||!r)&&("window"===n.state.pypestreamConfig.displayMode?n.closeWindow(n.state.dom.window):n.pe16380_FF?setTimeout((function(){n.state.dom.container.removeChild(n.state.dom.iframeWrapper)}),0):n.state.dom.container.removeChild(n.state.dom.iframeWrapper)),r&&(n.state.currentlyRedirecting=!1),n.state.ldClient&&n.state.ldClient.close()}else n.warn("You must call Pypestream.boot() before 'shutdown'.")})),r(this,"restartChat",(function(){var e,t;n.state.isConfigured&&n.state.hasBooted?null===(e=n.state.dom.iframe)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage({type:"RESTART_CHAT"},"*"):n.warn("You must call Pypestream.boot() before 'restart chat'.")})),r(this,"toggleInlineAppLoader",(function(e){var t=e.show;n.pe19356_FF&&n.state.dom.inlineAppLoader&&(n.state.dom.inlineAppLoader.style.display=t?"block":"none")})),r(this,"onShow",(function(e){n.addNewHandler("handleShow",e)})),r(this,"onFirstMessage",(function(e){n.addNewHandler("handleOnFirstMessage",e)})),r(this,"onSetupComplete",(function(e){n.addNewHandler("handleOnSetupComplete",e)})),r(this,"onMount",(function(e){n.addNewHandler("handleOnMount",e)})),r(this,"onHide",(function(e){n.addNewHandler("handleHide",e)})),r(this,"onChatEnd",(function(e){n.addNewHandler("handleChatEnd",e)})),r(this,"onChatRestart",(function(e){n.addNewHandler("handleChatRestart",e)})),r(this,"isVisible",(function(){return n.getVisibility()})),r(this,"registerForEvents",(function(e,t,r){Ke({registerForEvents:{eventHandles:e,eventTarget:t,eventBuffer:r},customEventQueue:n.state.customEventQueue,getIframe:n.getIframe,getHasSetupCompleted:n.getHasSetupCompleted})})),r(this,"removeUnwantedInlineAppLoaderElements",(function(){var e=n.state.dom;n.pe16380_FF?(e.inlineAppLoader&&e.container.contains(e.inlineAppLoader)&&e.container.removeChild(e.inlineAppLoader),e.inlineAppLoaderStyles&&e.container.contains(e.inlineAppLoaderStyles)&&e.container.removeChild(e.inlineAppLoaderStyles)):(e.inlineAppLoader&&e.container.removeChild(e.inlineAppLoader),e.inlineAppLoaderStyles&&e.container.removeChild(e.inlineAppLoaderStyles))})),r(this,"addNewHandler",(function(e,t){var r=n[e];n[e]=function(){r(),t()}})),r(this,"handleHide",(function(){console.warn("handleHide called"),n.state.isShowing=!1,n.setVisibility(!1),n.hideCI()})),r(this,"handleShow",(function(){n.state.isShowing=!0,n.setVisibility(!0),n.showCI()})),r(this,"handleOnFirstMessage",(function(){console.timeEnd("total_time_taken_for_first_message")})),r(this,"handleOnMount",(function(){console.timeEnd("total_time_taken_for_app_mount"),n.state.dom.iframeWrapper&&!n.state.pypestreamConfig.withInlineAppLoader&&(n.state.dom.iframeWrapper.style.display="")})),r(this,"handleOnSetupComplete",(function(){console.timeEnd("total_time_taken_to_complete_setup");var e=n.state,t=e.pypestreamConfig,r=e.dom,o=e.customEventQueue;"inline"===t.displayMode&&(r.iframeWrapper.style.display="",n.state.dom.iframe.focus(),n.removeUnwantedInlineAppLoaderElements()),n.state.hasSetupCompleted=!0,Xe({customEventQueue:o,iframe:r.iframe})})),r(this,"toggleSurvey",(function(e){e.enable?o.querySelector("#".concat(go)).classList.add("survey"):o.querySelector("#".concat(go)).classList.remove("survey")})),r(this,"handleChatEnd",(function(){n.state.isShowing=!1,n.state.pypestreamConfig.showSurveyForWindowMode&&(n.state.pypestreamConfig.displayMode="window",n.state.hasBooted=!1,n.state.pypestreamConfig.showSurveyForWindowMode=!1,o.body.removeChild(n.state.dom.container),n.state.dom.inlineAppLoader=null,n.state.dom.inlineAppLoaderStyles=null,n.state.dom.container=null,n.state.dom.iframeWrapper=null,n.state.dom.iframe=null,n.state.isAppIframeMounted=!1)})),r(this,"handleChatRestart",(function(){})),r(this,"postViewportDetails",(function(){var t,r;return null===(t=n.state.dom.iframe)||void 0===t||null===(r=t.contentWindow)||void 0===r?void 0:r.postMessage({type:"WINDOW_RESIZE",payload:{viewport:{width:e.innerWidth,height:e.innerHeight}}},"*")})),r(this,"postLocationDetails",(function(e){var t,r;return null===(t=n.state.dom.iframe)||void 0===t||null===(r=t.contentWindow)||void 0===r?void 0:r.postMessage({type:"LOCATION_CHANGE",payload:{updatedUrl:e}},"*")})),r(this,"handleSetSize",(function(e){var t=e.newWidth,r=e.newHeight;ct({height:r,width:t,shouldShowLauncher:!1,fixedPosition:!1,pe19536_FF:n.pe19536_FF,pe17591_FF:n.pe17591_FF,pe25604_FF:n.pe25604_FF,pe30718_FF:n.pe30718_FF}),n.state.dom.container.style.width="".concat(t+10,"px"),n.state.dom.container.style.height="".concat(r+10,"px"),n.state.dom.container.style.maxHeight="100%",n.state.dom.container.style.maxWidth="100%"})),r(this,"postShowChat",(function(){var e,t;null===(e=n.state.dom.iframe)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage({type:"SHOW_CHAT"},"*")})),r(this,"postHideChat",(function(){var e,t;null===(e=n.state.dom.iframe)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage({type:"HIDE_CHAT"},"*")})),r(this,"handleSetIframeTitle",(function(e){var t=e.title;n.state.dom.iframe&&t&&(n.state.dom.iframe.title=t)})),r(this,"appendPoliteNotifications",A((function(e,t){var n=o.createElement("div");n.innerHTML=$e.sanitize(t,{USE_PROFILES:{html:!0}}),e.appendChild(n),setTimeout((function(){n.remove()}),1500)}),350)),r(this,"debug",(function(e){!0===n.state.pypestreamConfig.debugMode&&console.warn("PSDEBUG: ".concat(e))})),r(this,"warn",(function(e){console.warn("Pypestream Warning: ".concat(e," \n        "))})),r(this,"getIframe",(function(){return n.state.dom.iframe})),r(this,"getHasSetupCompleted",(function(){return n.state.hasSetupCompleted})),r(this,"getOrigin",(function(e){var t=e.split("//"),n=t[0],r=t[1].split("/")[0];return"".concat(n,"//").concat(r)})),r(this,"initializeMessageBus",(function(){var e=ho();e.on(Yr,n.handleHide),e.on(Jr,n.handleShow),e.on($r,n.handleSetSize),e.on(Xr,n.toggleSurvey),e.on(Kr,(function(){n.state.surveyEnabled=!0})),e.on(Qr,(function(){n.state.hasBooted=!0})),e.on(eo,n.handleChatEnd),e.on(Zr,n.handleChatRestart),n.pe21763_FF&&e.on(uo,n.handleOnFirstMessage),n.pe21763_FF?e.on(to,n.handleOnSetupComplete):e.on(to,(function(){console.timeEnd("total_time_taken_to_complete_setup");var e=n.state,t=e.pypestreamConfig,r=e.dom,o=e.customEventQueue;"inline"===t.displayMode&&(r.iframeWrapper.style.display="",n.state.dom.iframe.focus(),n.pe16380_FF?(r.inlineAppLoader&&r.container.contains(r.inlineAppLoader)&&r.container.removeChild(r.inlineAppLoader),r.inlineAppLoaderStyles&&r.container.contains(r.inlineAppLoaderStyles)&&r.container.removeChild(r.inlineAppLoaderStyles)):(r.inlineAppLoader&&r.container.removeChild(r.inlineAppLoader),r.inlineAppLoaderStyles&&r.container.removeChild(r.inlineAppLoaderStyles))),n.state.hasSetupCompleted=!0,Xe({customEventQueue:o,iframe:r.iframe})})),n.pe21957_FF&&e.on(lo,n.handleOnMount),e.on(no,(function(e){o.body.style.background=e.overlay})),e.on(ro,(function(e){null!=e&&e.isChatEnded?yo.Off():n.state.onDifferentWindow&&!yo.interval&&yo.On("New Message")})),e.on(oo,(function(e){n.state.currentlyRedirecting=!(null==e||!e.redirecting)})),e.on(io,n.handleSetIframeTitle),e.on(so,(function(){})),e.on(ao,(function(e){if("polite"===e.type){var t=n.state.dom.ariaLivePoliteWrapper||o.getElementById("pypestream-aria-live-polite");o.createElement("div").innerHTML=$e.sanitize(e.message,{USE_PROFILES:{html:!0}}),t&&e.message&&n.appendPoliteNotifications(t,e.message)}else{var r=n.state.dom.ariaLiveAssertiveWrapper||o.getElementById("pypestream-aria-live-assertive"),i=o.createElement("div");i.innerHTML=$e.sanitize(e.message,{USE_PROFILES:{html:!0}}),r&&e.message&&r.append(i)}}))})),r(this,"startChat",function(){var e=t(u.mark((function e(t){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("inline"!==n.state.pypestreamConfig.displayMode){e.next=6;break}return n.state.dom.container=t,e.next=4,n.setupLD();case 4:return n.startInlineChat(t),e.abrupt("return");case 6:return n.startWindowChat(),e.abrupt("return");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r(this,"setupLD",(function(){return new Promise((function(e){var t;Gr(null===(t=n.state.pypestreamConfig)||void 0===t?void 0:t.APP_ID).then((function(t){var r=t.ldClient,o=t.allFlags;n.state.ldClient=r,o&&(n.inlineJsModeAppLoader_FF=null==o?void 0:o.inline_js_mode_app_loader,n.pe18296_FF=!!o["pe-18296"],n.pe16380_FF=!!o["pe-16380"],n.pe19356_FF=!!o["pe-19356"],n.pe19536_FF=!!o["pe-19536"],n.pe17591_FF=!!o["pe-17591"],n.pe20280_FF=!!o["pe-20280"],n.pe20135_FF=!!o["pe-20135"],n.pe20024_FF=!!o["pe-20024"],n.pe30557_FF=!!o["pe-30557"],n.pe21763_FF=!!o["pe-21763"],n.pe21957_FF=!!o["pe-21957"],n.pe25604_FF=!!o["pe-25604"],n.pe30718_FF=!!o["pe-30718"],n.pe21222_FF=!!o["pe-21222"]),e()})).catch((function(t){console.warn("LD setup failed",t.message),e()}))}))})),r(this,"startWindowChat",t(u.mark((function e(){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.state.dom.window=n.openWindow(),e.next=3,n.setupLD();case 3:n.mountIframeIntoPopup(n.origin);case 4:case"end":return e.stop()}}),e)})))),r(this,"onPopupClosed",(function(){if(n.state.surveyEnabled){var e;n.state.pypestreamConfig.showSurveyForWindowMode=!0,n.state.renderingSurveyForWindowMode=!0,n.state.pypestreamConfig.displayMode="inline",n.state.hasBooted=!1;var t=o.createElement("div");t.id="chat-container",t.style.position="fixed",t.style.right=0,t.style.bottom=0,o.body.appendChild(t),n.boot({APP_ID:null===(e=n.state.pypestreamConfig)||void 0===e?void 0:e.APP_ID,debugMode:!0},t)}else n.shutdown()})),r(this,"openWindow",(function(){var t=e.open("","_blank","width=".concat(500,",height=").concat(700,",scrollbars=no,menubar=no,titlebar=no,toolbar=no,status=no,location=no"));if(!t||t.closed||void 0===t.closed)return n.warn("You cannot open a browser window on page load. It must be tied to a user event."),{};d()?t.addEventListener("pagehide",(function(e){!1===e.persisted&&n.onPopupClosed()})):t.addEventListener("beforeunload",(function(){n.onPopupClosed()}));var r=t.document.createElement("meta");return r.name="viewport",r.content="width=device-width, initial-scale=1",t.document.head.appendChild(r),t.document.head.appendChild(st()),n.state.renderingSurveyForWindowMode=!1,t})),r(this,"closeWindow",(function(e){e.close()})),r(this,"focusWindow",(function(e){e.focus()})),r(this,"mountIframeIntoPopup",(function(t){var r,i=o.createElement("iframe");n.state.dom.iframe=i,n.state.isAppIframeMounted=!0,pt(i,nt),i.id=vo,i.classList.add("ps-pypestream-iframe"),i.onload=function(){n.debug("Iframe loaded");var t=o.referrer?o.referrer:e.location.origin,r=e.location.href,a=l("forceEnabledTracking");i.contentWindow.postMessage({type:"INIT_IFRAME",payload:{pypestreamConfig:bo(bo({},n.state.pypestreamConfig),{},{referring_site:t,last_viewed_url:r,forceEnabledTracking:a}),viewport:{width:e.innerWidth,height:e.innerHeight},pe30557_FF:n.pe30557_FF}},"*")},i.src=n.pe30557_FF?"".concat(t,"?parentSite=").concat(e.location.href):t,i.allow="geolocation;camera *;microphone *",i.crossorigin="anonymous";e.addEventListener("resize",(function(){e.clearTimeout(r),r=setTimeout(n.postViewportDetails,150)}),!1),n.initializeMessageBus(),n.state.dom.window.document.body.appendChild(i);var a=Ye(),s=a.wrapperElement,c=a.politeElement,u=a.assertiveElement;n.state.dom.window.document.body.appendChild(s),n.state.dom.ariaLiveWrapper=s,n.state.dom.ariaLivePoliteWrapper=c,n.state.dom.ariaLiveAssertiveWrapper=u,n.state.dom.window.document.body.style.margin=0,n.state.dom.window.document.title=o.title||"pypestream.com",Qe(n.postLocationDetails)})),r(this,"startInlineChat",(function(){!n.state.renderingSurveyForWindowMode&&n.state.pypestreamConfig.withInlineAppLoader?(console.time("mount_inline_app_loader"),n.mountInlineAppLoader().then((function(){console.timeEnd("mount_inline_app_loader"),console.time("load_react_app_in_iframe"),n.mountIframe(n.origin)}))):(console.time("load_react_app_in_iframe"),n.mountIframe(n.origin))})),r(this,"showCI",(function(){n.pe20024_FF&&d()&&W(o.querySelector("#".concat(go))),o.querySelector("#".concat(go)).classList.add("showing")})),r(this,"hideCI",(function(){n.pe20024_FF&&d()&&V(o.querySelector("#".concat(go))),o.querySelector("#".concat(go)).classList.remove("showing")})),r(this,"mountIframe",(function(t){var r,i=o.createElement("iframe");n.state.dom.iframe=i,n.state.isAppIframeMounted=!0,pt(i,nt),i.id=vo,i.title="Conversation Interface",i.classList.add("ps-pypestream-iframe"),i.onload=function(){console.timeEnd("load_react_app_in_iframe"),n.debug("Iframe loaded");var t=Ye(),r=t.wrapperElement,a=t.politeElement,s=t.assertiveElement;o.body.appendChild(r),n.state.dom.ariaLiveWrapper=r,n.state.dom.ariaLivePoliteWrapper=a,n.state.dom.ariaLiveAssertiveWrapper=s;var c=o.referrer?o.referrer:e.location.origin,u=e.location.href,d=l("forceEnabledTracking");i.contentWindow.postMessage({type:"INIT_IFRAME",payload:{pypestreamConfig:bo(bo({},n.state.pypestreamConfig),{},{referring_site:c,last_viewed_url:u,forceEnabledTracking:d}),viewport:{width:e.innerWidth,height:e.innerHeight},pe30557_FF:n.pe30557_FF}},"*")},i.src=n.pe30557_FF?"".concat(t,"?parentSite=").concat(e.location.href):t,i.allow="geolocation;camera *;microphone *",i.crossorigin="anonymous";e.addEventListener("resize",(function(){e.clearTimeout(r),r=setTimeout(n.postViewportDetails,150)}),!1),n.initializeMessageBus(),Qe(n.postLocationDetails);var a=o.createElement("div");a.id=go,a.setAttribute("role","region"),a.setAttribute("aria-labelledby",vo),a.classList.add("ps-pypestream-wrapper"),n.pe21957_FF?n.state.pypestreamConfig.withInlineAppLoader&&(a.style.display="none"):a.style.display="none",at(n.pe19536_FF,n.pe17591_FF,n.pe21222_FF,n.pe25604_FF,n.pe30718_FF),st(),a.appendChild(i),n.state.dom.container.appendChild(a),n.state.dom.iframeWrapper=a})),r(this,"mountInlineAppLoader",(function(){return new Promise((function(e){var t,r=null===(t=n.state.pypestreamConfig)||void 0===t?void 0:t.APP_ID;fetch("".concat("https://widget-format-sbx.pype.tech","/pd").concat(r),{cache:"no-store"}).then((function(e){return e.json()})).then((function(t){var r=JSON.parse(null==t?void 0:t.style),i=o.createElement("div");i.className="ps-loader-wrapper",i.innerHTML='<div class="ps-loader"><div class="ps-loader-circular-path"><svg class="ps-loader-svg-container" viewBox="22 22 44 44"><circle cx="44" cy="44" r="21.5" fill="none" /></svg></div><div class="ps-loader-logo-wrapper" aria-label="Loading Icon"><img src='.concat(t.pype_logo,' alt=""/></div></div>');var a,s,c=o.createElement("style");c.innerHTML=(a={widgetColor:r.widgetStyleColor},s=a.widgetColor,"\n    .ps-loader-wrapper {\n      width: 100%;\n      height: 100%;\n      position: relative;\n      border-radius: inherit;\n      z-index: 2;\n      background: -webkit-gradient( linear, right top, left bottom, from(rgba(255,255,255,0)), to(rgba(255,255,255,0.15)) ), ".concat(s,";\n      background: -o-linear-gradient( top right, rgba(255,255,255,0), rgba(255,255,255,0.15) ), ").concat(s,";\n      background: linear-gradient( to bottom left, rgba(255,255,255,0), rgba(255,255,255,0.15) ), ").concat(s,";\n      border-top-left-radius: 16px;\n      border-top-right-radius: 16px;\n    }\n\n    .ps-loader {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      -webkit-transform: translate(-50%,-50%);\n      -ms-transform: translate(-50%,-50%);\n      transform: translate(-50%,-50%);\n      width: 125px;\n      height: 125px;\n    }\n\n    .ps-loader-circular-path {\n      width: 100%;\n      height: 100%;\n      color: #fff;\n      display: inline-block;\n      -webkit-animation: CircularProgress-keyframes-circular-rotate 1.4s linear infinite;\n              animation: CircularProgress-keyframes-circular-rotate 1.4s linear infinite;\n    }\n\n    .ps-loader-svg-container {\n      display: block;\n      overflow: hidden;\n      color: #fff;\n    }\n\n    .ps-loader-svg-container circle {\n      -webkit-animation: CircularProgress-keyframes-circular-dash 1.4s ease-in-out infinite;\n              animation: CircularProgress-keyframes-circular-dash 1.4s ease-in-out infinite;\n      stroke-dasharray: 80px, 200px;\n      stroke-dashoffset: 0px;\n      stroke: currentColor;\n    }\n\n    .ps-loader-logo-wrapper {\n      height: 90%;\n      width: 90%;\n      position: absolute;\n      -webkit-transform: translate(-50%,-50%);\n      -ms-transform: translate(-50%,-50%);\n      transform: translate(-50%,-50%);\n      top: 50%;\n      left: 50%;\n      display: -webkit-inline-box;\n      display: -ms-inline-flexbox;\n      display: inline-flex;\n    }\n\n    .ps-loader-logo-wrapper img {\n      max-width: 100%;\n      max-height: 100%;\n      border-radius: 50%;\n      -webkit-animation: image-scale-animation 1s ease-in-out infinite alternate;\n              animation: image-scale-animation 1s ease-in-out infinite alternate;\n    }\n\n    @-webkit-keyframes CircularProgress-keyframes-circular-rotate {\n      0% {\n        -webkit-transform-origin: 50% 50%;\n                transform-origin: 50% 50%;\n      }\n      100% {\n        -webkit-transform: rotate(360deg);\n                transform: rotate(360deg);\n      }\n    }\n\n    @keyframes CircularProgress-keyframes-circular-rotate {\n      0% {\n        -webkit-transform-origin: 50% 50%;\n                transform-origin: 50% 50%;\n      }\n      100% {\n        -webkit-transform: rotate(360deg);\n                transform: rotate(360deg);\n      }\n    }\n    \n    @-webkit-keyframes CircularProgress-keyframes-circular-dash {\n      0% {\n        stroke-dasharray: 1px, 200px;\n        stroke-dashoffset: 0px;\n      }\n      50% {\n        stroke-dasharray: 100px, 200px;\n        stroke-dashoffset: -15px;\n      }\n      100% {\n        stroke-dasharray: 100px, 200px;\n        stroke-dashoffset: -125px;\n      }\n    }\n    \n    @keyframes CircularProgress-keyframes-circular-dash {\n      0% {\n        stroke-dasharray: 1px, 200px;\n        stroke-dashoffset: 0px;\n      }\n      50% {\n        stroke-dasharray: 100px, 200px;\n        stroke-dashoffset: -15px;\n      }\n      100% {\n        stroke-dasharray: 100px, 200px;\n        stroke-dashoffset: -125px;\n      }\n    }\n\n    @-webkit-keyframes image-scale-animation {\n      0% {\n        -webkit-transform: scale(0.85);\n                transform: scale(0.85);\n      }\n      100% {\n        -webkit-transform: scale(0.9);\n                transform: scale(0.9);\n      }\n    }\n\n    @keyframes image-scale-animation {\n      0% {\n        -webkit-transform: scale(0.85);\n                transform: scale(0.85);\n      }\n      100% {\n        -webkit-transform: scale(0.9);\n                transform: scale(0.9);\n      }\n    }\n")),n.state.dom.container.style.width="".concat(r.widgetWidth+10,"px"),n.state.dom.container.style.height="".concat(r.widgetHeight+10,"px"),n.state.dom.container.style.maxHeight="100%",n.state.dom.container.style.maxWidth="100%",n.state.dom.container.appendChild(c),n.state.dom.container.appendChild(i),n.state.dom.inlineAppLoader=i,n.state.dom.inlineAppLoaderStyles=c,n.pe20135_FF&&t.custom_pype_css&&ft(t.custom_pype_css),e()})).catch((function(){console.error("Something went wrong while loading pype with app_id: ".concat(r))}))}))})),r(this,"setVisibility",(function(e){!function(e,t){try{localStorage.setItem(e,t)}catch(e){return null}}("pypestream-chat-visible",e)})),r(this,"getVisibility",(function(){return JSON.parse(function(e){try{return localStorage.getItem(e)}catch(e){return null}}("pypestream-chat-visible")||!1)})),r(this,"onWindowVisibilityChange",(function(){Ze((function(e){o[e]?n.state.onDifferentWindow=!0:(yo.Off(),n.state.onDifferentWindow=!1)}))})),this.origin=this.getOrigin(o.currentScript.src),this.state={pypestreamConfig:{debugMode:!1,APIMode:!0,displayMode:"window",withInlineAppLoader:!0,initialMessages:{welcomeMessage:"",showNextThinkingBubble:!0}},isConfigured:!1,hasBooted:!1,isShowing:!1,hasSetupCompleted:!1,isAppIframeMounted:!1,dom:{container:null,iframeWrapper:null,iframe:null,window:null,ariaLiveWrapper:null,ariaLivePoliteWrapper:null,ariaLiveAssertiveWrapper:null},customEventQueue:[],onDifferentWindow:!1,surveyEnabled:!1,renderingSurveyForWindowMode:!1,currentlyRedirecting:!1,ldClient:null}}var a,s,c;return a=i,(s=[{key:"updatePypestreamConfig",value:function(e){var t,n=null===(t=this.state.dom.iframe)||void 0===t?void 0:t.contentWindow;this.state.isAppIframeMounted?n&&this.pe20280_FF&&n.postMessage({type:"UPDATE_PYPESTREAM_CONFIG",payload:{pypestreamConfig:e}},"*"):this.warn("You must call/wait for Pypestream.boot() before calling updatePypestreamConfig!")}}])&&n(a.prototype,s),c&&n(a,c),Object.defineProperty(a,"prototype",{writable:!1}),i}();!function(){if(e.Pypestream)console.error("Pypestream API already declared.");else{var t=new i,n=function(e){var n=Array.prototype.slice.call(arguments,1);return t[e].apply(t,n)};n.config=t.config,n.boot=t.boot,n.show=t.show,n.hide=t.hide,n.toggle=t.toggle,n.shutdown=t.shutdown,n.restartChat=t.restartChat,n.onShow=t.onShow,n.onHide=t.onHide,n.onChatEnd=t.onChatEnd,n.onChatRestart=t.onChatRestart,n.isVisible=t.isVisible,n.registerForEvents=t.registerForEvents,n.onWindowVisibilityChange=t.onWindowVisibilityChange,n.updatePypestreamConfig=t.updatePypestreamConfig,n.onSetupComplete=t.onSetupComplete,n.onFirstMessage=t.onFirstMessage,n.onMount=t.onMount,e.Pypestream=n,n.onWindowVisibilityChange()}}()}(window,document)}();